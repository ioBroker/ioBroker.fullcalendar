"use strict";(self.webpackChunkiobroker_vis_2_widgets_fullcalendar=self.webpackChunkiobroker_vis_2_widgets_fullcalendar||[]).push([["src_Component_Calendar_js-src_Component_CalendarsSelector_js"],{99165:function(e,t,n){n.d(t,{Z:function(){return te}});var a=n(74165),i=n(15861),l=n(29439),r=n(4819),s=n(54261),o=n(58503),c=n(90575),d=n(38217),u=n(52720),v=n(74332),m=n(26309),f=n(49704),h=n(96906),g=n(59862),p=n(21431),x=n(82104),y=n(29688),b=n(89283),j=n(10207),w=n(44417),C=n(35422),S=n(32201),k=n(94427),T=n(75606),O=n(36402),D=n(35325),I=n.n(D);function Z(e){if("*"===e||"?"===e||""===e)return e;for(var t=e.split(","),n=[],a=0;a<t.length;a++){var i=t[a].match(/(\d+)-(\d+)/);if(i)for(var l=parseInt(i[1],10);l<=parseInt(i[2],10);l++)n.push(l);else n.push(parseInt(t[a],10))}return n}function N(e,t){var n={};if(t){var a=t.split(/\D/);n.seconds=[parseInt(a[5],10)],n.minutes=[parseInt(a[4],10)],n.hours=[parseInt(a[3],10)],n.dates=[parseInt(a[2],10)],n.months=[parseInt(a[1],10)],n.dows="?"}else{var i=e.replace(/\s\s/g," ").replace(/\s\s/g," ").split(" ");6===i.length?(n.seconds=Z(i[0]),n.minutes=Z(i[1]),n.hours=Z(i[2]),n.dates=Z(i[3]),n.months=Z(i[4]),n.dows=Z(i[5])):(n.seconds=[0],n.minutes=Z(i[0]),n.hours=Z(i[1]),n.dates=Z(i[2]),n.months=Z(i[3]),n.dows=Z(i[4]))}return n}function E(e){if("*"===e||"?"===e)return e;if("string"===typeof e&&(e=parseInt(e,10)),"object"!==typeof e&&(e=[e]),e.sort((function(e,t){return e-t})),e.length<3)return e.join(",");for(var t=[],n=e[0],a=e[0],i=1;i<e.length;i++)e[i]===a+1?a++:(n!==a?n+1===a?t.push("".concat(n,",").concat(a)):t.push("".concat(n,"-").concat(a)):t.push(n),n=e[i],a=e[i]);return n!==a?n+1===a?t.push("".concat(n,",").concat(a)):t.push("".concat(n,"-").concat(a)):t.push(n),t.join(",")}function _(e){var t=[];return e.seconds&&t.push(E(e.seconds)),t.push(E(e.minutes)),t.push(E(e.hours)),t.push(E(e.dates)),t.push(E(e.months)),t.push(E(e.dows)),t.join(" ")}function M(e,t){if("cron"===t){var n=N(e),a=new Date;return a.setHours(n.hours[0]),a.setMinutes(n.minutes[0]),a.setSeconds(n.seconds[0]),Array.isArray(n.dows)&&a.setDate(a.getDate()+n.dows[0]-a.getDay()),a}return"date"===t?new Date(e):null}function A(e,t){if("cron"===t)return{minutes:[(e=new Date(e.getTime())).getMinutes()],hours:[e.getHours()]};if("date"===t){var n=(e=new Date(e.getTime()-6e4*(new Date).getTimezoneOffset())).toISOString();return n.substring(0,n.length-5)}return null}var L=n(1413),F=n(72426),B=n.n(F),P=(n(15255),n(23333),n(42173),n(91115),n(593),n(45098),n(17897),n(63054),n(18300),n(44289),n(97892)),W=n.n(P),R=n(35811),H=n(24750),V=n(71652),z=n(59665),J=n(80184),G={single:"single_description",double:"double_description",toggle:"toggle_description"},U=["sunrise","sunriseEnd","goldenHourEnd","solarNoon","goldenHour","sunsetStart","sunset","dusk","nauticalDusk","night","nadir","nightEnd","nauticalDawn","dawn"];function Y(){return(Y=(0,i.Z)((0,a.Z)().mark((function e(t,n){var i,l,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=6;break}return e.next=3,n.getObject(t);case 3:i=e.sent,e.next=7;break;case 6:i=t;case 7:if(l=null,!(i&&i.common&&i.common.icon)){e.next=12;break}l=T.Utils.getObjectIcon(i),e.next=31;break;case 12:if("state"!==i.type){e.next=31;break}return(r=i._id.split(".")).pop(),s=r.join("."),e.next=18,n.getObject(s);case 18:if(!((i=e.sent)&&i.common&&i.common.icon)){e.next=23;break}l=T.Utils.getObjectIcon(i),e.next=31;break;case 23:if(i&&"channel"!==i.type&&"device"!==i.type){e.next=31;break}return(r=i._id.split(".")).pop(),s=r.join("."),e.next=29,n.getObject(s);case 29:(i=e.sent)&&i.common&&i.common.icon&&(l=T.Utils.getObjectIcon(i));case 31:return e.abrupt("return",l);case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=(0,o.withStyles)((function(e){return{field:{padding:"2px 0px"},tableCell:{textAlign:"center"},typeDescription:{fontSize:12,whiteSpace:"normal",fontStyle:"italic"},selectId:{display:"flex",alignItems:"center",gap:8},timeType:{width:150},narrowText:{width:140,marginLeft:8},width60:{width:80,marginLeft:16},narrowText2:{minWidth:150,marginRight:8},narrowColor:{width:200},dayTable:{marginLeft:20,display:"inline-block"},randomTime:{marginLeft:16,width:133},timeSelector:{marginLeft:16},days:{backgroundColor:"dark"===e.palette.mode?"#656565":"#dadada"}}}))((function(e){var t,n,s,o,c,d,u,v,m,f,h,g,p,x,y,b=null!==(t=e.event)&&void 0!==t&&null!==(n=t.native)&&void 0!==n&&n.intervals&&e.event.native.intervals[0]&&e.event.native.intervals[0].timeOffset?e.event.native.intervals[0].timeOffset/6e4:0,j=null!==(s=e.event)&&void 0!==s&&null!==(o=s.native)&&void 0!==o&&o.intervals&&e.event.native.intervals[0]&&void 0!==e.event.native.intervals[0].value?e.event.native.intervals[0].value:"",w=(0,r.useState)(!1),C=(0,l.Z)(w,2),S=C[0],O=C[1],D=(0,r.useState)(e.event),Z=(0,l.Z)(D,2),E=Z[0],F=Z[1],P=(0,r.useState)(null),$=(0,l.Z)(P,2),K=$[0],q=$[1],Q=(0,r.useState)(!1),X=(0,l.Z)(Q,2),ee=X[0],te=X[1],ne=(0,r.useState)(b),ae=(0,l.Z)(ne,2),ie=ae[0],le=ae[1],re=(0,r.useState)(j),se=(0,l.Z)(re,2),oe=se[0],ce=se[1],de=(0,r.useState)({}),ue=(0,l.Z)(de,2),ve=ue[0],me=ue[1];B().locale(e.language);var fe=(0,r.useCallback)((function(e){var t=JSON.parse(JSON.stringify(E));e(t),F(t)}),[E]);(0,r.useEffect)((function(){var t,n=new Date;n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);var a,i=I().getTimes(n,e.systemConfig.latitude,e.systemConfig.longitude);if(me(i),null!==(t=E.native)&&void 0!==t&&t.oid){if(!K||K._id!==(null===(a=E.native)||void 0===a?void 0:a.oid))try{var l;e.socket.getObject(null===(l=E.native)||void 0===l?void 0:l.oid).then((function(t){var n;JSON.stringify(null===(n=E.native)||void 0===n?void 0:n.states)!==JSON.stringify(t.common.states)&&fe((function(e){return e.native.states=t.common.states})),(K||e.event.native.oid!==E.native.oid)&&function(e,t){return Y.apply(this,arguments)}(t,e.socket).then((function(e){return fe((function(t){return t.common.icon=e}))})),q(t)}))}catch(r){console.error("Cannot get object ".concat(E.native.oid,": ").concat(r)),q(null)}}else q(null)}),[null===(c=E.native)||void 0===c?void 0:c.oid,e.socket,fe,null===(d=E.native)||void 0===d?void 0:d.states,K,null===(u=e.event)||void 0===u?void 0:u.native.oid,e.systemConfig.latitude,e.systemConfig.longitude]);var he,ge,pe=null!==(v=E.native)&&void 0!==v&&v.cron?N(E.native.cron):null,xe="once",ye=29;if(Array.isArray(null===pe||void 0===pe?void 0:pe.months)){var be,je;xe="monthly";var we=[4,6,9,11],Ce=[1,3,5,7,8,10,12];null!==(be=pe.months)&&void 0!==be&&be.find((function(e){return Ce.includes(e)}))?ye=31:null!==(je=pe.months)&&void 0!==je&&je.find((function(e){return we.includes(e)}))&&(ye=30)}else Array.isArray(null===pe||void 0===pe?void 0:pe.dows)&&(xe="daily");if(E)if("once"===xe)he=M(null===(ge=E.native)||void 0===ge?void 0:ge.start,"date",e.serverTimeZone);else if("monthly"===xe||"daily"===xe){var Se;he=M(null===(Se=E.native)||void 0===Se?void 0:Se.cron,"cron",e.serverTimeZone)}var ke=JSON.stringify(e.event)!==JSON.stringify(E)||ie!==b||oe!==j,Te="monday"===(null===(m=e.systemConfig)||void 0===m?void 0:m.firstDayOfWeek)?[1,2,3,4,5,6,0]:[0,1,2,3,4,5,6],Oe=null!==(f=E.native)&&void 0!==f&&f.astro&&ve?ve[E.native.astro]:"",De=Oe?Oe.toLocaleTimeString().replace(/:\d\d$/,""):"",Ie="";null!==(h=E.native)&&void 0!==h&&h.astro&&null!==(g=E.native)&&void 0!==g&&g.offset&&Oe&&(Ie=new Date(Oe.getTime()+6e4*E.native.offset).toLocaleTimeString().replace(/:\d\d$/,""));var Ze,Ne,Ee,_e,Me=null===E||void 0===E?void 0:E.common.icon;return!Me||Me.startsWith("data:image")||Me.startsWith("http")||Me.startsWith("/")||(Me="../../".concat(Me)),e.event?(0,J.jsxs)(k.Dialog,{open:!0,onClose:e.onClose,fullWidth:!0,children:[(0,J.jsx)(k.DialogTitle,{children:e.t("Configure event")}),(0,J.jsxs)(k.DialogContent,{children:[S&&(0,J.jsx)(T.SelectID,{imagePrefix:"../..",selected:E.native.oid,disabled:e.readOnly,onOk:function(e){fe((function(t){return t.native.oid=e})),O(!1)},onClose:function(){return O(!1)},socket:e.socket}),(0,J.jsx)("div",{className:e.classes.field,children:(0,J.jsx)(k.FormControlLabel,{control:(0,J.jsx)(k.Checkbox,{checked:!(null===E||void 0===E||!E.common.enabled),disabled:e.readOnly,onChange:function(e){return fe((function(t){return t.common.enabled=e.target.checked}))}}),label:e.t("Active")})}),(0,J.jsxs)("div",{className:e.classes.field,children:[(0,J.jsxs)(k.FormControl,{style:{width:180},variant:"standard",className:e.classes.timeType,children:[(0,J.jsx)(k.InputLabel,{children:e.t("Time type")}),(0,J.jsx)(k.Select,{value:E.native.astro?"astro":"time",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){"astro"===e.target.value?t.native.astro="sunrise":delete t.native.astro}))},renderValue:function(t){return e.t(t)},children:["time","astro"].map((function(t){return(0,J.jsx)(k.MenuItem,{value:t,children:(0,J.jsx)("div",{children:e.t(t)})},t)}))})]}),E.native.astro?(0,J.jsxs)(k.FormControl,{style:{width:250},className:e.classes.narrowText,variant:"standard",children:[(0,J.jsx)(k.InputLabel,{children:e.t("Astronomic event")}),(0,J.jsx)(k.Select,{value:E.native.astro||"",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.native.astro=e.target.value}))},renderValue:function(t){return e.t(t)},children:U.map((function(t){return(0,J.jsx)(k.MenuItem,{value:t,children:(0,J.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,J.jsx)("span",{children:e.t(t)}),(0,J.jsx)("span",{style:{flexGrow:1}}),(0,J.jsxs)("span",{children:[" ","- [",ve&&ve[t]?ve[t].toLocaleTimeString().replace(/:\d\d$/,""):"??:??","]"]})]})},t)}))})]}):(0,J.jsx)(V._,{dateAdapter:H.y,children:(0,J.jsx)(R.j,{label:e.t("Time"),variant:"standard",className:e.classes.timeSelector,value:he?W()(he):null,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(t){if(t)try{fe((function(n){if("once"===xe)n.native.start=A(t.toDate(),"date",e.serverTimeZone);else if("monthly"===xe||"daily"===xe){var a=N(n.native.cron),i=A(t.toDate(),"cron",e.serverTimeZone);a.hours=i.hours,a.minutes=i.minutes,n.native.cron=_(a)}}))}catch(n){}},renderInput:function(t){return(0,J.jsx)(k.TextField,(0,L.Z)((0,L.Z)({},t),{},{variant:"standard",className:"".concat(e.classes.narrowText," ").concat(e.classes.timeSelector),helperText:he.getSeconds()?he.toLocaleTimeString():""}))},ampm:!1})}),E.native.astro?(0,J.jsxs)(k.FormControl,{variant:"standard",style:{width:95},className:e.classes.width60,children:[(0,J.jsx)(k.InputLabel,{children:e.t("Offset")}),(0,J.jsx)(k.Select,{value:E.native.offset||0,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.native.offset=e.target.value}))},children:[{label:"none",value:0},{label:"5 min",value:5},{label:"10 min",value:10},{label:"15 min",value:15},{label:"20 min",value:20},{label:"30 min",value:30},{label:"45 min",value:45},{label:"1 hour",value:60},{label:"1.5 hours",value:90},{label:"2 hours",value:120},{label:"2.5 hours",value:150},{label:"3 hours",value:180},{label:"4 hours",value:240},{label:"5 min",value:-5},{label:"10 min",value:-10},{label:"15 min",value:-15},{label:"20 min",value:-20},{label:"30 min",value:-30},{label:"45 min",value:-45},{label:"1 hour",value:-60},{label:"1.5 hours",value:-90},{label:"2 hours",value:-120},{label:"2.5 hours",value:-150},{label:"3 hours",value:-180},{label:"4 hours",value:-240}].map((function(t){return(0,J.jsx)(k.MenuItem,{value:t.value,children:t.value<0?"- ".concat(e.t(t.label)):e.t(t.label)},t.value)}))})]}):null,e.isSimulation&&(0,J.jsx)(k.TextField,{className:e.classes.randomTime,label:e.t("Time random offset"),value:E.native.timeRandomOffset||0,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.native.timeRandomOffset=parseInt(e.target.value)}))},variant:"standard",InputProps:{endAdornment:(0,J.jsx)(k.InputAdornment,{position:"end",children:e.t("ms")})}})]}),E.native.astro?(0,J.jsxs)("div",{className:e.classes.field,children:[e.t("Today %s is at %s.",e.t(E.native.astro),De),"\xa0",E.native.offset?e.t("With offset at %s.",Ie):null]}):null,(0,J.jsxs)("div",{className:e.classes.field,children:[!e.isSimulation&&(0,J.jsxs)(k.FormControl,{variant:"standard",className:e.classes.narrowText2,children:[(0,J.jsx)(k.InputLabel,{children:e.t("Event type")}),(0,J.jsx)(k.Select,{value:E.native.type||"",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(t){return fe((function(n){n.common.name===e.t(n.native.type)&&(n.common.name=e.t(t.target.value)),n.native.type=t.target.value}))},renderValue:function(t){return e.t(t)},children:["single","double","toggle"].map((function(t){return(0,J.jsx)(k.MenuItem,{value:t,children:(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{children:e.t(t)}),(0,J.jsx)("div",{className:e.classes.typeDescription,children:e.t(G[t])})]})},t)}))})]}),"single"!==E.native.type&&(0,J.jsx)(k.TextField,{label:e.t("Duration"),value:ie,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return le(e.target.value)},variant:"standard",className:e.classes.narrowText,InputProps:{endAdornment:(0,J.jsx)(k.InputAdornment,{position:"end",children:e.t("minutes")})}})]}),(0,J.jsx)("div",{className:e.classes.field,children:(0,J.jsxs)("div",{className:e.classes.selectId,children:[(0,J.jsx)(T.Icon,{src:Me||"",style:{width:32,height:32}}),(0,J.jsx)(k.TextField,{label:"Object ID",value:E.native.oid||"",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.native.oid=e.target.value}))},variant:"standard",helperText:(Ee=(null===K||void 0===K?void 0:K.common.name)||"",_e=e.language,Ee&&"object"===typeof Ee?Ee[_e]||Ee.en:Ee),fullWidth:!0}),(0,J.jsx)(k.Button,{onClick:function(){return O(!0)},children:"..."})]})}),(0,J.jsxs)("div",{className:e.classes.field,children:[(Ze="startValue",Ne="toggle"===E.native.type?"First value":"single"===E.native.type?"Desired value":"Start value",K?"boolean"===K.common.type?("startValue"===Ze&&"boolean"!==typeof E.native[Ze]&&setTimeout((function(){return fe((function(e){return e.native[Ze]=!!e.native[Ze]}))}),100),(0,J.jsx)(k.FormControlLabel,{className:e.classes.narrowText2,control:(0,J.jsx)(k.Checkbox,{checked:!!E.native[Ze],disabled:e.readOnly,onChange:function(e){return fe((function(t){return t.native[Ze]=e.target.checked}))}}),label:(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{children:e.t(Ne)}),(0,J.jsx)("div",{style:{fontSize:10,fontStyle:"italic"},children:e.t("Checked means ON, unchecked means OFF")})]})})):K.common.states?(0,J.jsxs)(k.FormControl,{className:e.classes.narrowText2,variant:"standard",children:[(0,J.jsx)(k.InputLabel,{children:e.t(Ne)}),(0,J.jsx)(k.Select,{value:E.native[Ze]||"",disabled:e.readOnly,onChange:function(e){return fe((function(t){return t.native[Ze]=e.target.value}))},children:Object.keys(K.common.states).map((function(e){return(0,J.jsx)(k.MenuItem,{value:e,children:K.common.states[e]},e)}))})]}):(0,J.jsx)(k.TextField,{className:e.classes.narrowText2,label:e.t(Ne),value:E.native[Ze]||"",disabled:e.readOnly,onChange:function(e){return fe((function(t){return t.native[Ze]=e.target.value}))},variant:"standard"}):null),"double"===E.native.type&&(K?"boolean"===K.common.type?("boolean"!==typeof oe&&setTimeout((function(){return ce(!!oe)}),100),(0,J.jsx)(k.FormControlLabel,{className:e.classes.narrowText2,control:(0,J.jsx)(k.Checkbox,{checked:!!oe,disabled:e.readOnly,onChange:function(e){return ce(e.target.checked)}}),label:(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{children:e.t("End value")}),(0,J.jsx)("div",{style:{fontSize:10,fontStyle:"italic"},children:e.t("Checked means ON, unchecked means OFF")})]})})):K.common.states?(0,J.jsxs)(k.FormControl,{className:e.classes.narrowText2,variant:"standard",children:[(0,J.jsx)(k.InputLabel,{children:e.t("End value")}),(0,J.jsx)(k.Select,{value:oe||"",disabled:e.readOnly,onChange:function(e){return ce(e.target.value)},children:Object.keys(K.common.states).map((function(e){return(0,J.jsx)(k.MenuItem,{value:e,children:K.common.states[e]},e)}))})]}):(0,J.jsx)(k.TextField,{label:e.t("End value"),value:oe||"",disabled:e.readOnly,onChange:function(e){return ce(e.target.value)},variant:"standard",className:e.classes.narrowText2}):null)]}),(0,J.jsxs)("div",{className:e.classes.field,children:[!e.isSimulation&&(0,J.jsxs)(k.FormControl,{variant:"standard",children:[(0,J.jsx)(k.InputLabel,{children:e.t("Period")}),(0,J.jsx)(k.Select,{value:xe||"once",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(t){t.target.value!==E.native.cron&&fe((function(n){if("once"===t.target.value)delete n.native.cron,n.native.start=A(he,"date",e.serverTimeZone);else if("daily"===t.target.value){delete n.native.start;var a=N("0 0 ? * 0-6"),i=A(he,"cron",e.serverTimeZone);a.hours=i.hours,a.minutes=i.minutes,n.native.cron=_(a)}else if("monthly"===t.target.value){var l,r=n.native.start;r?(l=N("0 0 ".concat(new Date(r).getDate()," ").concat(new Date(r).getMonth()+1," *")),delete n.native.start):l=N("0 0 1-31 1-12 *");var s=A(he,"cron",e.serverTimeZone);l.hours=s.hours,l.minutes=s.minutes,n.native.cron=_(l)}}))},children:["once","daily","monthly"].map((function(t){return(0,J.jsx)(k.MenuItem,{value:t,children:e.t(t)},t)}))})]}),"daily"===xe&&(!e.isSimulation||"week"===e.simulation.native.interval)&&(0,J.jsxs)("table",{className:e.classes.dayTable,style:e.isSimulation?{marginLeft:0}:void 0,children:[(0,J.jsx)("thead",{children:(0,J.jsx)("tr",{children:Te.map((function(t){return(0,J.jsx)("td",{className:e.classes.tableCell,children:B()().day(t).format("ddd")},t)}))})}),(0,J.jsx)("tbody",{children:(0,J.jsx)("tr",{children:Te.map((function(t){var n;return(0,J.jsx)("td",{children:(0,J.jsx)(k.Checkbox,{"aria-label":"day",checked:(null===pe||void 0===pe||null===(n=pe.dows)||void 0===n?void 0:n.includes(t))||!1,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(n){var a=N(n.native.cron);e.target.checked?a.dows.push(t):a.dows=a.dows.filter((function(e){return e!==t})),n.native.cron=_(a)}))},size:"small"})},t)}))})})]})]}),"monthly"===xe&&(0,J.jsxs)("div",{className:e.classes.field,children:[(0,J.jsxs)("table",{children:[(0,J.jsx)("thead",{children:(0,J.jsx)("tr",{children:new Array(12).fill(null).map((function(t,n){return(0,J.jsx)("td",{className:e.classes.tableCell,children:B()().month(n).format("MMM")},n)}))})}),(0,J.jsx)("tbody",{children:(0,J.jsx)("tr",{children:new Array(12).fill(null).map((function(t,n){var a;return(0,J.jsx)("td",{children:(0,J.jsx)(k.Checkbox,{"aria-label":"month",checked:(null===pe||void 0===pe||null===(a=pe.months)||void 0===a?void 0:a.includes(n+1))||!1,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){var a=N(t.native.cron);e.target.checked?a.months.push(n+1):a.months=a.months.filter((function(e){return e!==n+1})),t.native.cron=_(a)}))},size:"small"})},n)}))})})]}),(0,J.jsxs)("table",{children:[(0,J.jsx)("thead",{children:(0,J.jsx)("tr",{className:e.classes.days,children:new Array(12).fill(null).map((function(t,n){return(0,J.jsx)("td",{className:e.classes.tableCell,children:n+1},n)}))})}),(0,J.jsxs)("tbody",{children:[(0,J.jsx)("tr",{className:e.classes.days,children:new Array(12).fill(null).map((function(t,n){var a;return(0,J.jsx)("td",{children:(0,J.jsx)(k.Checkbox,{"aria-label":"day",checked:(null===pe||void 0===pe||null===(a=pe.dates)||void 0===a?void 0:a.includes(n+1))||!1,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){var a=N(t.native.cron);e.target.checked?(a.dates.push(n+1),a.dates=a.dates.filter((function(e){return e}))):a.dates=a.dates.filter((function(e){return e!==n+1})),t.native.cron=_(a)}))},size:"small"})},n)}))}),(0,J.jsx)("tr",{className:e.classes.days,children:new Array(12).fill(null).map((function(t,n){return(0,J.jsx)("td",{className:e.classes.tableCell,children:n+13},n)}))}),(0,J.jsx)("tr",{className:e.classes.days,children:new Array(12).fill(null).map((function(t,n){var a;return(0,J.jsx)("td",{children:(0,J.jsx)(k.Checkbox,{"aria-label":"day",checked:(null===pe||void 0===pe||null===(a=pe.dates)||void 0===a?void 0:a.includes(n+13))||!1,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){fe((function(t){var a=N(t.native.cron);e.target.checked?(a.dates.push(n+13),a.dates=a.dates.filter((function(e){return e}))):a.dates=a.dates.filter((function(e){return e!==n+13})),t.native.cron=_(a)}))},size:"small"})},n)}))}),(0,J.jsxs)("tr",{className:e.classes.days,children:[new Array(11).fill(null).map((function(t,n){return(0,J.jsx)("td",{className:e.classes.tableCell,children:ye<n+25?null:n+25},n)})),(0,J.jsx)("td",{className:e.classes.tableCell,children:e.t("All")})]}),(0,J.jsxs)("tr",{className:e.classes.days,children:[new Array(11).fill(null).map((function(t,n){var a;return(0,J.jsx)("td",{children:ye<n+25?null:(0,J.jsx)(k.Checkbox,{"aria-label":"day",checked:(null===pe||void 0===pe||null===(a=pe.dates)||void 0===a?void 0:a.includes(n+25))||!1,disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){var a=N(t.native.cron);e.target.checked?(a.dates.push(n+25),a.dates=a.dates.filter((function(e){return e}))):a.dates=a.dates.filter((function(e){return e!==n+25})),t.native.cron=_(a)}))},size:"small"})},n)})),(0,J.jsx)("td",{children:(0,J.jsx)(k.Checkbox,{"aria-label":"all",checked:(null===pe||void 0===pe||null===(p=pe.dates)||void 0===p?void 0:p.length)===ye,indeterminate:(null===pe||void 0===pe||null===(x=pe.dates)||void 0===x?void 0:x.length)!==ye&&!(null!==pe&&void 0!==pe&&pe.dates.includes(0)),disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(){return fe((function(e){var t,n=N(e.native.cron);if((null===n||void 0===n||null===(t=n.dates)||void 0===t?void 0:t.length)!==ye){n.dates=[];for(var a=0;a<ye;a++)n.dates.push(a+1)}else n.dates=[1];e.native.cron=_(n)}))},size:"small"})})]})]})]})]}),(0,J.jsx)("div",{className:e.classes.field,children:(0,J.jsx)(k.TextField,{label:"Description",value:(null===E||void 0===E?void 0:E.common.name)||"",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.common.name=e.target.value}))},variant:"standard",fullWidth:!0})}),(0,J.jsx)("div",{className:e.classes.narrowColor,children:(0,J.jsx)(T.ColorPicker,{value:E.common.color||E.native.color||"",disabled:e.readOnly||!(null!==E&&void 0!==E&&E.common.enabled),onChange:function(e){return fe((function(t){return t.common.color=e}))},name:e.t("Color")})})]}),(0,J.jsxs)(k.DialogActions,{children:[e.readOnly?null:(0,J.jsx)(k.Button,{variant:"contained",color:"secondary",startIcon:(0,J.jsx)(z.Delete,{}),onClick:function(){return te(!0)},children:e.t("Delete")}),e.readOnly||e.widget?null:(0,J.jsx)("div",{style:{flex:1}}),e.readOnly?null:(0,J.jsx)(k.Button,{variant:"contained",color:"primary",disabled:!ke||"monthly"===xe&&(!(null!==(y=pe.dates)&&void 0!==y&&y.length)||pe.dates.includes(0)),startIcon:(0,J.jsx)(z.Save,{}),onClick:(0,i.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single"===E.native.type?E.native.intervals&&delete E.native.intervals:"double"===E.native.type?(E.native.intervals=E.native.intervals||[],E.native.intervals[0]=E.native.intervals[0]||{},E.native.intervals[0].timeOffset=6e4*(parseFloat(ie)||1),E.native.intervals[0].value=oe):"toggle"===E.native.type&&(E.native.intervals=E.native.intervals||[],E.native.intervals[0]=E.native.intervals[0]||{},E.native.intervals[0].timeOffset=6e4*(parseFloat(ie)||1)),t.next=3,e.setEvent(E._id,E);case 3:e.updateEvents(),e.onClose();case 5:case"end":return t.stop()}}),t)}))),children:e.t("Save")}),(0,J.jsx)(k.Button,{variant:"contained",color:"grey",startIcon:(0,J.jsx)(z.Cancel,{}),onClick:e.onClose,children:e.readOnly||!ke?e.t("ra_Close"):e.t("ra_Cancel")})]}),ee&&(0,J.jsx)(T.Confirm,{fullWidth:!1,title:e.t("Delete event"),text:e.t("Event will be deleted. Confirm?"),suppressQuestionMinutes:5,dialogName:"deleteConfirmDialog",ok:e.t("Delete"),onClose:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(n){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=11;break}return t.prev=1,t.next=4,e.deleteEvent(E._id);case 4:e.updateEvents(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),window.alert("Cannot delete event: ".concat(t.t0));case 10:e.onClose();case 11:te(!1);case 12:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()})]}):null})),K=[{type:"single",name:"Single event"},{type:"double",name:"Double event"},{type:"toggle",name:"Toggle event"}],q=[1,2,3,5,10,15,20,30,60],Q=function(e){var t=e.type,n=e.t,a=e.color,i=(0,r.useRef)(null);return(0,r.useEffect)((function(){var e=new v._l(i.current,{eventData:function(){return{id:t.type,title:n(t.name),create:!0,extendedProps:{type:t.type}}}});return function(){e.destroy()}}),[]),(0,J.jsx)("div",{style:{backgroundColor:a||"rgb(58, 135, 178)",color:"white",cursor:"pointer",fontSize:"14px",padding:"3px 4px 6px 8px",borderRadius:4,marginBottom:20},ref:i,children:n(t.name)})};function X(e){if(e)return e.startsWith("#")?4===e.length?"#".concat(e[1]).concat(e[1]).concat(e[2]).concat(e[2]).concat(e[3]).concat(e[3],"50"):"".concat(e.substring(0,7),"50"):e.startsWith("rgb(")?e.replace("rgb(","rgba(").replace(")",", 0.3)"):e.startsWith("rgba(")?e.replace(/,\s?[.\d]+\)$/,", 0.3)"):e}function ee(e){return e.date.second?"".concat(e.date.hour,":").concat(e.date.minute.toString().padStart(2,"0"),":").concat(e.date.second.toString().padStart(2,"0")):"".concat(e.date.hour,":").concat(e.date.minute.toString().padStart(2,"0"))}var te=(0,o.withTheme)((0,o.withStyles)((function(){return{container:{display:"flex",width:"100%",flex:1},leftBlock:{width:200},calendarBlock:{flex:1,display:"flex"},calendar:{marginRight:20,width:"100%"},leftPaper:{margin:20},leftContent:{display:"flex",flexDirection:"column",padding:"20px 10px"},hr:{width:"100%"}}}))((function(e){var t,n,o=(0,r.useState)(null),D=(0,l.Z)(o,2),Z=D[0],E=D[1],L=(0,r.useState)(e.dayStep||parseInt(window.localStorage.getItem("calendarStep"),10)||30),F=(0,l.Z)(L,2),B=F[0],P=F[1],W=e.storageName||"calendar",R=(0,r.useRef)(null),H=(0,r.useRef)(null),V=(0,r.useRef)(null),z=(0,r.useRef)(null),G=(0,r.useRef)(null),U=(0,r.useState)({start:null,end:null}),Y=(0,l.Z)(U,2),te=Y[0],ne=Y[1],ae=(!e.widget&&window.localStorage.getItem("".concat(W,"Start")),new Date),ie=e.viewMode||window.localStorage.getItem("".concat(W,"View"))||"dayGridMonth";e.isSimulation&&(ae=new Date,ie="day"===(null===(n=e.simulation)||void 0===n?void 0:n.native.interval)?"timeGridDay":"timeGridWeek");var le=K;e.isSimulation&&(le=le.filter((function(e){return"single"===e.type})));var re=(0,r.useMemo)((function(){var t=[];return e.events.forEach((function(n){var a;if(n){var i=null!==(a=n.native)&&void 0!==a&&a.intervals&&n.native.intervals[0]&&n.native.intervals[0].timeOffset?n.native.intervals[0].timeOffset:30;n.common.color=n.common.color||"#3a87b2";var l=n.common.enabled?n.common.color:X(n.common.color),r=T.Utils.invertColor(n.common.color,!0);n.common.enabled||(r=X(r));var s=n.common.name;if(n.native.oid){var o,c,d=n.native.startValue;"boolean"===typeof d?d=d?T.I18n.t("ON"):T.I18n.t("OFF"):n.native.states&&n.native.states[d]&&(d=n.native.states[d]);var u,v,m,f,h=null===(o=n.native.intervals)||void 0===o||null===(c=o[0])||void 0===c?void 0:c.value;if("boolean"===typeof h?h=h?T.I18n.t("ON"):T.I18n.t("OFF"):n.native.states&&n.native.states[h]&&(h=n.native.states[h]),s="".concat(n.common.name," \u2192 ").concat(d),"double"===n.native.type)s+=" \u2192 ".concat(((null===(u=n.native.intervals)||void 0===u||null===(v=u[0])||void 0===v?void 0:v.timeOffset)||0)/1e3/60," ").concat(T.I18n.t("min"),". \u2192 ").concat(h);if("toggle"===n.native.type)s+=" \u2192 ".concat(((null===(m=n.native.intervals)||void 0===m||null===(f=m[0])||void 0===f?void 0:f.timeOffset)||0)/1e3/60," ").concat(T.I18n.t("min"),". \u2192 ").concat(T.I18n.t("initial"))}if(n.native.cron){var g=M(n.native.cron,"cron",e.serverTimeZone),p=N(n.native.cron);if(g.setFullYear((new Date).getFullYear()-1),Array.isArray(p.months))new O.Ci({dtstart:g,until:te.end||new Date,freq:O.Ci.MONTHLY,bymonth:p.months,bymonthday:p.dates}).between(te.start||new Date,te.end||new Date).forEach((function(a){var i=n.native.astro?I().getTimes(a,e.systemConfig.latitude,e.systemConfig.longitude)[n.native.astro]:a;n.native.astro&&n.native.offset&&i.setMinutes(i.getMinutes()+n.native.offset),t.push({extendedProps:{eventId:n._id,icon:n.common.icon,type:n.native.type,seconds:i.getSeconds()},title:s,backgroundColor:l,textColor:r,start:i,allDay:!1,display:"block"})}));else if(Array.isArray(p.dows)){new O.Ci({dtstart:g,until:te.end||new Date,freq:O.Ci.WEEKLY,byweekday:p.dows.map((function(e){return 0===e?6:e-1}))}).between(te.start||new Date,te.end||new Date).forEach((function(a){var i=n.native.astro?I().getTimes(a,e.systemConfig.latitude,e.systemConfig.longitude)[n.native.astro]:a;n.native.astro&&n.native.offset&&i.setMinutes(i.getMinutes()+n.native.offset),t.push({extendedProps:{eventId:n._id,icon:n.common.icon,type:n.native.type,seconds:i.getSeconds()},title:s,backgroundColor:l,textColor:r,start:i,allDay:!1,display:"block"})}))}else t.push({extendedProps:{eventId:n._id,icon:n.common.icon,type:n.native.type,seconds:0},title:s,backgroundColor:l,textColor:r,icon:n.common.icon})}else{var x=n.native.astro?I().getTimes(new Date,e.systemConfig.latitude,e.systemConfig.longitude)[n.native.astro]:n.native.start;n.native.astro&&n.native.offset&&x.setMinutes(x.getMinutes()+n.native.offset),t.push({extendedProps:{eventId:n._id,icon:n.common.icon,type:n.native.type,seconds:0},title:s,display:"block",backgroundColor:l,textColor:r,start:M(x,"date",e.serverTimeZone),end:M(new Date(new Date(x).getTime()+i),"date",e.serverTimeZone)})}}})),t}),[e.events,e.serverTimeZone,e.systemConfig.latitude,e.systemConfig.longitude,te.end,te.start]);if((0,r.useEffect)((function(){if(e.widget){setTimeout((function e(){var t,n=null===(t=R.current)||void 0===t?void 0:t.getApi();n&&(console.log("Scroll to now"),n.scrollToTime((new Date).getTime())),V.current?z.current=null:z.current=setTimeout((function(){return e}),3e5)}),1e3)}return function(){z.current&&clearTimeout(z.current),z.current=null,V.current&&clearTimeout(V.current),V.current=null}}),[]),(0,r.useEffect)((function(){G.current=null,setTimeout((function(){var e,t=new Date;null===(e=R.current)||void 0===e||e.getApi().scrollToTime("".concat(t.getHours().toString().padStart(2,"0"),":").concat((B>t.getMinutes()?0:t.getMinutes()-B).toString().padStart(2,"0"),":00"))}),300)}),[e.calendarPrefix,e.simulationId,B]),(0,r.useEffect)((function(){if(e.isSimulation){var t,n,a=null===(t=R.current)||void 0===t?void 0:t.getApi();null===a||void 0===a||a.changeView("day"===(null===(n=e.simulation)||void 0===n?void 0:n.native.interval)?"timeGridDay":"timeGridWeek",new Date)}}),[e.isSimulation,null===(t=e.simulation)||void 0===t?void 0:t.native.interval]),e.isSimulation&&!e.simulation)return null;var se=G.current?void 0:new Date,oe=se?"".concat(se.getHours().toString().padStart(2,"0"),":").concat((B>se.getMinutes()?0:se.getMinutes()-B).toString().padStart(2,"0"),":00"):void 0;return console.log("SCROLL TIME: ".concat(oe)),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("style",{children:"dark"===e.theme.palette.mode?"\n:root {\n    --fc-neutral-bg-color: hsla(0,0%,12%);\n    --fc-list-event-hover-bg-color: hsla(0,0%,12%);\n}\n.fc-col-header-cell {\n    background-color: #1e1e1e;\n}                \n":"\n.fc-col-header-cell {\n    background-color: #EEEEEE;\n}\n"}),Z?(0,J.jsx)($,{systemConfig:e.systemConfig,widget:e.widget,event:e.events.find((function(e){return(null===e||void 0===e?void 0:e._id)===Z})),onClose:function(){E(null);var e=G.current?new Date(G.current):new Date,t="".concat(e.getHours().toString().padStart(2,"0"),":").concat((B>e.getMinutes()?0:e.getMinutes()-B).toString().padStart(2,"0"),":00");setTimeout((function(){var e;return null===(e=R.current)||void 0===e?void 0:e.getApi().scrollToTime(t)}),200)},socket:e.socket,updateEvents:e.updateEvents,setEvent:e.setEvent,deleteEvent:function(t){E(null),e.deleteEvent(t)},serverTimeZone:e.serverTimeZone,readOnly:e.readOnly,t:e.t,language:e.language,isSimulation:e.isSimulation,simulationId:e.simulationId,simulation:e.simulation}):null,(0,J.jsxs)("div",{className:e.classes.container,children:[!e.hideLeftBlock&&!e.readOnly&&(0,J.jsxs)("div",{className:e.classes.leftBlock,children:[(0,J.jsx)(k.Paper,{elevation:4,className:e.classes.leftPaper,children:(0,J.jsxs)("div",{className:e.classes.leftContent,children:[(0,J.jsx)("h4",{children:e.t("Events")}),le.map((function(t,n){var a,i;return(0,J.jsx)(Q,{t:e.t,type:t,name:e.t(t.name),index:n,color:e.isSimulation?null===(a=e.simulation)||void 0===a||null===(i=a.common)||void 0===i?void 0:i.color:void 0},t.type)})),e.hideLeftBlockHint?null:(0,J.jsx)("div",{children:e.t("Drag and drop the events above to create a new one.")}),e.hideLeftBlockHint?null:(0,J.jsx)("hr",{className:e.classes.hr}),e.hideLeftBlockHint?null:(0,J.jsx)("div",{children:e.t("Use ALT by dragging it to copy the events.")}),e.hideLeftBlockHint?null:(0,J.jsx)("hr",{className:e.classes.hr}),e.hideLeftBlockHint?null:(0,J.jsx)("div",{children:e.t("Use double click on calendar to add new events.")}),e.hideLeftBlockHint?null:(0,J.jsx)("hr",{className:e.classes.hr}),e.hideLeftBlockHint?null:(0,J.jsxs)(k.FormControl,{fullWidth:!0,variant:"standard",children:[(0,J.jsx)(k.InputLabel,{children:e.t("Zoom")}),(0,J.jsx)(k.Select,{value:B,onChange:function(e){var t,n;if(null!==(t=R.current)&&void 0!==t&&null!==(n=t.elRef)&&void 0!==n&&n.current){var a=function(e){for(var t=e.getBoundingClientRect(),n=e.getElementsByClassName("fc-timegrid-slot"),a=0;a<n.length;a++)if(n[a].getBoundingClientRect().top>t.top+100)return n[a].dataset.time;return null}(R.current.elRef.current);a&&setTimeout((function(){var e;return null===(e=R.current)||void 0===e?void 0:e.getApi().scrollToTime(a)}),300)}window.localStorage.setItem("calendarStep",e.target.value.toString()),P(e.target.value)},children:q.map((function(t){return(0,J.jsxs)(k.MenuItem,{value:t,children:[t,e.t("min")]},t)}))})]})]})}),e.button]}),(0,J.jsx)("div",{className:e.classes.calendarBlock,children:(0,J.jsx)("div",{className:e.classes.calendar,children:(0,J.jsx)(c.Z,{ref:R,plugins:[f.Z,d.Z,u.Z,v.ZP,m.Z],weekends:!e.hideWeekends,headerToolbar:!e.hideTopBlock&&{left:e.hideTopBlockButtons||e.isSimulation?"":"prev,next today",center:e.isSimulation?"":"title",right:e.hideTopBlockButtons||e.isSimulation?"":"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},eventTimeFormat:e.isSimulation?ee:void 0,slotDuration:"00:".concat(B.toString().padStart(2,"0"),":00"),eventMinHeight:20,initialView:ie,initialDate:ae,editable:!e.readOnly,selectable:!0,selectMirror:!0,nowIndicator:!0,dayMaxEvents:!0,eventResizableFromStart:!e.isSimulation,eventDurationEditable:!e.isSimulation,defaultTimedEventDuration:"00:".concat(B.toString().padStart(2,"0")),events:re,height:"calc(100% - 20px)",locales:[h.Z,g.Z,p.Z,x.Z,y.Z,b.Z,j.Z,w.Z,C.Z,S.Z],locale:e.language,datesSet:function(t){var n,a;t.start.toString()===(null===(n=te.start)||void 0===n?void 0:n.toString())&&t.end.toString()===(null===(a=te.end)||void 0===a?void 0:a.toString())||(G.current=null,ne({start:t.start,end:t.end})),e.widget?(z.current&&clearTimeout(z.current),z.current=null,V.current&&clearTimeout(V.current),V.current=setTimeout((function(){V.current=null;!function e(){var t,n=null===(t=R.current)||void 0===t?void 0:t.getApi();null===n||void 0===n||n.scrollToTime((new Date).getTime()),V.current?z.current=null:z.current=setTimeout((function(){return e}),3e5)}()}),6e4)):window.localStorage.setItem("".concat(W,"View"),t.view.type)},eventClick:function(e){G.current=new Date(e.event.start).getTime(),E(e.event.extendedProps.eventId)},eventResize:function(t){var n;G.current=new Date(t.event.start).getTime();var a=e.events.find((function(e){return e._id===t.event.extendedProps.eventId}));if(null!==(n=a.native.intervals)&&void 0!==n&&n[0].timeOffset){var i=JSON.parse(JSON.stringify(a));i.native.intervals[0].timeOffset+=t.endDelta.milliseconds,e.setEvent(i._id,i),e.updateEvents()}else t.revert()},eventDrop:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(n){var i,l,r,o,c,d;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(G.current=new Date(n.event.start).getTime(),null===(l=e.events.find((function(e){return e._id===n.event.extendedProps.eventId})))||void 0===l||null===(i=l.native)||void 0===i||!i.cron){t.next=15;break}return r=JSON.parse(JSON.stringify(l)),n.jsEvent.altKey&&(r._id="".concat(e.calendarPrefix||e.simulationId,".event-").concat((0,s.Z)())),o=N(r.native.cron),c=A(n.event.start,"cron",e.serverTimeZone),o.hours=c.hours,o.minutes=c.minutes,r.native.cron=_(o),t.next=12,e.setEvent(r._id,r);case 12:e.updateEvents(),t.next=21;break;case 15:return d=JSON.parse(JSON.stringify(l)),n.jsEvent.altKey&&(d._id="".concat(e.calendarPrefix||e.simulationId,".event-").concat((0,s.Z)())),d.native.start=A(n.event.start,"date",e.serverTimeZone),t.next=20,e.setEvent(d._id,d);case 20:e.updateEvents();case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),eventReceive:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(n){var i,l;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={_id:"".concat(e.calendarPrefix||e.simulationId,".event-").concat((0,s.Z)()),common:{name:n.event.title,enabled:!0,color:"#3A87AD"},native:{id:Date.now(),start:A(n.event.start,"date",e.serverTimeZone),type:n.event.extendedProps.type,oid:"",startValue:""},type:"schedule"},"single"!==n.event.extendedProps.type&&(i.native.intervals=[{timeOffset:18e5}]),e.isSimulation&&(i.common.color=e.simulation.common.color||i.common.color,delete i.native.start,(l=A(n.event.start,"cron",e.serverTimeZone)).dows="day"===e.simulation.native.interval?[0,1,2,3,4,5,6]:[n.event.start.getDay()],l.dates=["?"],l.months=["*"],i.native.cron=_(l),i.native.record={states:[],enums:[],start:null,end:null}),G.current=new Date(n.event.start).getTime(),t.next=6,e.setEvent(i._id,i);case 6:e.updateEvents(),setTimeout((function(){return E(i._id)}),100);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),eventDidMount:function(e){var t=e.event.extendedProps.icon;if(t){var n=window.document.createElement("img");t.startsWith("data:image")||t.startsWith("http")||t.startsWith("/")||(t="../../".concat(t)),n.setAttribute("src",t),n.className="icon",n.style.width="20px",n.style.height="20px";var a=e.el.getElementsByClassName("fc-event-title-container");if(a.length){a[0].prepend(n);var i=a[0].getElementsByClassName("fc-event-title");i.length&&(i[0].style.marginLeft="23px")}}},select:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(n){var i,l;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.view.calendar.unselect(),!e.readOnly){t.next=4;break}return t.abrupt("return");case 4:if(i=n.end.getTime()-n.start.getTime(),H.current&&!(Date.now()-H.current>500)||18e5!==i){t.next=8;break}return H.current=Date.now(),t.abrupt("return");case 8:return l={_id:"".concat(e.calendarPrefix||e.simulationId,".event-").concat((0,s.Z)()),common:{name:e.t("Single event"),enabled:!0,color:"#3A87AD"},native:{id:Date.now(),start:A(n.date||n.start,"date",e.serverTimeZone),intervals:n.end&&!e.isSimulation?[{value:"",timeOffset:n.end.getTime()-n.start.getTime()}]:void 0,type:n.end&&!e.isSimulation?"double":"single",oid:"",startValue:""},type:"schedule"},e.isSimulation&&(l.common.color=e.simulation.common.color||l.common.color),G.current=new Date(l.native.start).getTime(),t.next=13,e.setEvent(l._id,l);case 13:return t.next=15,e.updateEvents();case 15:setTimeout((function(){return E(l._id)}),100);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})})})]})]})})))},54794:function(e,t,n){var a=n(15671),i=n(43144),l=n(60136),r=n(27277),s=n(4819),o=n.n(s),c=n(94427),d=n(75606),u=n(88411),v=n(80184),m=window.visRxWidget||u.VisRxWidget,f=function(e){(0,l.Z)(n,e);var t=(0,r.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e)).state={list:[{value:"",label:m.t("default")}]},i}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.instance&&this.props.socket.getObjectViewSystem("folder","fullcalendar.".concat(this.props.instance,".Calendars."),"fullcalendar.".concat(this.props.instance,".Calendars.\u9999")).then((function(t){var a=Object.keys(t).map((function(e){return{value:e,label:n.getText(t[e].common.name)}}));a.unshift({value:"",label:m.t("default")}),e.setState({list:a})}))}},{key:"render",value:function(){var e=this;return(0,v.jsx)(c.Select,{variant:"standard",fullWidth:!0,value:this.props.value||"",onChange:function(t){return e.props.onChange(t.target.value)},children:this.state.list.map((function(e){return(0,v.jsx)(c.MenuItem,{value:e.value,children:e.label},e.value)}))})}}],[{key:"getText",value:function(e){return"object"===typeof e?e[d.I18n.getLanguage()]||e.en:e}}]),n}(o().Component);t.Z=f}}]);
//# sourceMappingURL=src_Component_Calendar_js-src_Component_CalendarsSelector_js.eeadc4db.chunk.js.map