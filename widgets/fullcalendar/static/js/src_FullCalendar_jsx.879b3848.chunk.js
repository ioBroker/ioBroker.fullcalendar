"use strict";(self.webpackChunkiobroker_vis_2_widgets_fullcalendar=self.webpackChunkiobroker_vis_2_widgets_fullcalendar||[]).push([["src_FullCalendar_jsx"],{4278:function(B,m,s){s.r(m);var y=s(4819),c=s.n(y),g=s(15854),d=s.n(g),h=s(58503),P=s.n(h),_=s(75606),W=s.n(_),E=s(88411),C=s.n(E),D=s(83178),b=Object.defineProperty,O=(n,e,t)=>e in n?b(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,u=(n,e,t)=>(O(n,typeof e!="symbol"?e+"":e,t),t),k=(n,e,t)=>new Promise((a,l)=>{var r=i=>{try{v(t.next(i))}catch(p){l(p)}},f=i=>{try{v(t.throw(i))}catch(p){l(p)}},v=i=>i.done?a(i.value):Promise.resolve(i.value).then(r,f);v((t=t.apply(n,e)).next())});const M=()=>({content:{display:"flex",width:"100%",height:"100%",overflow:"auto"}}),x=window.visRxWidget||E.VisRxWidget;class o extends x{constructor(e){super(e),u(this,"onEventsChanged",(t,a)=>{const l=JSON.parse(JSON.stringify(this.state.events)),r=l.findIndex(f=>f._id===t);r!==-1?a?l[r]=a:l.splice(r,1):l.push(a),this.setState({events:l})}),u(this,"updateEvents",()=>k(this,null,function*(){const t=yield this.props.socket.getObjectViewCustom("schedule","schedule",`fullcalendar.${this.state.rxData.instance}.`,`fullcalendar.${this.state.rxData.instance}.\u9999`);let a=0;try{const l=yield this.props.socket.getState("fullcalendar.0.info.timeZone");a=(l==null?void 0:l.val)||0}catch(l){}this.setState({events:Object.values(t),serverTimeZone:a})})),u(this,"changeEvents",t=>{this.setState({events:t})}),this.widgetRef=c().createRef()}static getWidgetInfo(){return{id:"tplFullCalendar",visSet:"fullcalendar",visWidgetLabel:"fullcalendar",visSetLabel:"set_label",visSetColor:"#112233",visName:"Full calendar",visAttrs:[{name:"common",fields:[{label:"instance",name:"instance",type:"instance",adapter:"fullcalendar",isShort:!0},{label:"read_only",name:"readOnly",type:"checkbox",default:!1},{label:"hide_left_block",name:"hideLeftBlock",type:"checkbox",hidden:e=>e.readOnly,default:!1},{label:"hide_left_block_hint",name:"hideLeftBlockHint",type:"checkbox",hidden:e=>e.readOnly||e.hideLeftBlock,default:!1},{label:"hide_top_block",name:"hideTopBlock",type:"checkbox",default:!1},{label:"hide_top_block_buttons",name:"hideTopBlockButtons",type:"checkbox",hidden:e=>e.hide_top_block,default:!1},{label:"hide_weekends",name:"hideWeekends",type:"checkbox",default:!1},{label:"view_mode",name:"viewMode",type:"select",options:[{label:"full_calendar_dayGridMonth",value:"dayGridMonth"},{label:"full_calendar_timeGridWeek",value:"timeGridWeek"},{label:"full_calendar_timeGridDay",value:"timeGridDay"},{label:"full_calendar_listMonth",value:"listMonth"}],default:"dayGridMonth"},{label:"name",name:"name",tooltip:"used_only_with_relative",default:"",hidden:(e,t,a)=>a&&a.position!=="relative"}]}],visDefaultStyle:{width:"100%",height:355,position:"relative"},visPrev:"widgets/fullcalendar/img/prev_fullcalendar.png"}}static t(e,...t){return _.I18n.t(`full_calendar_${e}`,...t)}getWidgetInfo(){return o.getWidgetInfo()}componentDidMount(){super.componentDidMount(),this.props.socket.subscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),this.updateEvents()}componentWillUnmount(){this.props.socket.unsubscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),super.componentWillUnmount()}onRxDataChanged(){this.updateEvents()}renderWidgetBody(e){var t;super.renderWidgetBody(e),(t=this.widgetRef.current)!=null&&t.offsetWidth||this.forceUpdate();const a=c().createElement("div",{className:this.props.classes.content,ref:this.widgetRef},c().createElement(D.Z,{widget:!0,key:this.state.rxData.viewMode,events:this.state.events||[],socket:this.props.socket,instance:this.state.rxData.instance,changeEvents:this.changeEvents,updateEvents:this.updateEvents,serverTimeZone:this.state.serverTimeZone||0,readOnly:this.state.rxData.readOnly||!1,hideLeftBlock:this.state.rxData.hideLeftBlock||!1,hideTopBlock:this.state.rxData.hideTopBlock||!1,hideLeftBlockHint:this.state.rxData.hideLeftBlockHint||!1,hideTopBlockButtons:this.state.rxData.hideTopBlockButtons||!1,viewMode:this.state.rxData.viewMode||null,storageName:`fc_${this.props.id}`,hideWeekends:this.state.rxData.hideWeekends||!1,t:o.t,language:_.I18n.getLanguage()}));return this.state.rxStyle.position==="relative"?this.wrapContent(a,null,{height:"calc(100% - 24px)",width:"calc(100% - 24px)"}):a}}o.propTypes={systemConfig:d().object,socket:d().object,themeType:d().string,style:d().object,data:d().object},m.default=(0,h.withStyles)(M)((0,h.withTheme)(o))}}]);

//# sourceMappingURL=src_FullCalendar_jsx.879b3848.chunk.js.map