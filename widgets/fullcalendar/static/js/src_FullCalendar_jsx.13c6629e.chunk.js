"use strict";(self.webpackChunkiobroker_vis_2_widgets_fullcalendar=self.webpackChunkiobroker_vis_2_widgets_fullcalendar||[]).push([["src_FullCalendar_jsx"],{4278:function(B,E,s){s.r(E);var y=s(4819),c=s.n(y),g=s(15854),o=s.n(g),h=s(58503),x=s.n(h),_=s(94427),W=s.n(_),u=s(75606),T=s.n(u),D=s(88411),L=s.n(D),b=s(83178),O=Object.defineProperty,M=(n,e,t)=>e in n?O(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,f=(n,e,t)=>(M(n,typeof e!="symbol"?e+"":e,t),t),C=(n,e,t)=>new Promise((l,a)=>{var r=i=>{try{p(t.next(i))}catch(m){a(m)}},v=i=>{try{p(t.throw(i))}catch(m){a(m)}},p=i=>i.done?l(i.value):Promise.resolve(i.value).then(r,v);p((t=t.apply(n,e)).next())});const P=()=>({content:{display:"flex",width:"100%",height:"100%",overflow:"auto"}}),k=window.visRxWidget||D.VisRxWidget;class d extends k{constructor(e){super(e),f(this,"onEventsChanged",(t,l)=>{const a=JSON.parse(JSON.stringify(this.state.events)),r=a.findIndex(v=>v._id===t);r!==-1?l?a[r]=l:a.splice(r,1):a.push(l),this.setState({events:a})}),f(this,"updateEvents",()=>C(this,null,function*(){const t=yield this.props.socket.getObjectViewCustom("schedule","schedule",`fullcalendar.${this.state.rxData.instance}.`,`fullcalendar.${this.state.rxData.instance}.\u9999`);let l=0;try{const a=yield this.props.socket.getState("fullcalendar.0.info.timeZone");l=(a==null?void 0:a.val)||0}catch(a){}this.setState({events:Object.values(t),serverTimeZone:l})})),f(this,"changeEvents",t=>{this.setState({events:t})}),this.widgetRef=c().createRef()}static getWidgetInfo(){return{id:"tplFullCalendar",visSet:"fullcalendar",visWidgetLabel:"fullcalendar",visSetLabel:"set_label",visSetColor:"#112233",visName:"Full calendar",visAttrs:[{name:"common",fields:[{label:"instance",name:"instance",type:"instance",adapter:"fullcalendar",isShort:!0},{label:"read_only",name:"readOnly",type:"checkbox",default:!1},{label:"hide_left_block",name:"hideLeftBlock",type:"checkbox",hidden:e=>e.readOnly,default:!1},{label:"hide_left_block_hint",name:"hideLeftBlockHint",type:"checkbox",hidden:e=>e.readOnly||e.hideLeftBlock,default:!1},{label:"hide_top_block",name:"hideTopBlock",type:"checkbox",default:!1},{label:"hide_top_block_buttons",name:"hideTopBlockButtons",type:"checkbox",hidden:e=>e.hide_top_block,default:!1},{label:"hide_weekends",name:"hideWeekends",type:"checkbox",default:!1},{label:"view_mode",name:"viewMode",type:"select",options:[{label:"full_calendar_dayGridMonth",value:"dayGridMonth"},{label:"full_calendar_timeGridWeek",value:"timeGridWeek"},{label:"full_calendar_timeGridDay",value:"timeGridDay"},{label:"full_calendar_listMonth",value:"listMonth"}],default:"dayGridMonth"},{label:"name",name:"name",tooltip:"used_only_with_relative",default:"",hidden:(e,t,l)=>l&&l.position!=="relative"}]}],visDefaultStyle:{width:"100%",height:355,position:"relative"},visPrev:"widgets/fullcalendar/img/prev_fullcalendar.png"}}static t(e,...t){return u.I18n.t(`full_calendar_${e}`,...t)}getWidgetInfo(){return d.getWidgetInfo()}componentDidMount(){super.componentDidMount(),this.props.socket.subscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),this.updateEvents()}componentWillUnmount(){this.props.socket.unsubscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),super.componentWillUnmount()}onRxDataChanged(){this.updateEvents()}renderWidgetBody(e){var t,l;super.renderWidgetBody(e),(t=this.widgetRef.current)!=null&&t.offsetWidth||this.forceUpdate();const a=c().createElement("div",{className:this.props.classes.content,ref:this.widgetRef},c().createElement(b.Z,{widget:!0,systemConfig:(l=this.props.systemConfig)==null?void 0:l.common,key:this.state.rxData.viewMode,events:this.state.events||[],socket:this.props.socket,instance:this.state.rxData.instance,changeEvents:this.changeEvents,updateEvents:this.updateEvents,serverTimeZone:this.state.serverTimeZone||0,readOnly:this.state.rxData.readOnly||!1,hideLeftBlock:this.state.rxData.hideLeftBlock||!1,hideTopBlock:this.state.rxData.hideTopBlock||!1,hideLeftBlockHint:this.state.rxData.hideLeftBlockHint||!1,hideTopBlockButtons:this.state.rxData.hideTopBlockButtons||!1,viewMode:this.state.rxData.viewMode||null,storageName:`fc_${this.props.id}`,hideWeekends:this.state.rxData.hideWeekends||!1,t:d.t,language:u.I18n.getLanguage()}));return this.state.rxStyle.position==="relative"?this.wrapContent(a,null,{height:"calc(100% - 24px)",width:"calc(100% - 24px)"},null,null,{Card:_.Card,CardContent:_.CardContent}):a}}d.propTypes={systemConfig:o().object,socket:o().object,themeType:o().string,style:o().object,data:o().object},E.default=(0,h.withStyles)(P)((0,h.withTheme)(d))}}]);

//# sourceMappingURL=src_FullCalendar_jsx.13c6629e.chunk.js.map