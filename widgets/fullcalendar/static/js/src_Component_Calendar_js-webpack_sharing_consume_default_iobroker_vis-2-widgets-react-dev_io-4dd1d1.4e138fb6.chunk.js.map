{"version":3,"file":"static/js/src_Component_Calendar_js-webpack_sharing_consume_default_iobroker_vis-2-widgets-react-dev_io-4dd1d1.4e138fb6.chunk.js","mappings":"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","sources":["Component/Utils.js","Component/EventDialog.js","Component/Calendar.js"],"sourcesContent":["function sortNumbers(a, b) {\r\n    return a - b;\r\n}\r\n\r\nfunction oneCron2Array(str) {\r\n    if (str === '*' || str === '?' || str === '') return str;\r\n\r\n    const parts = str.split(',');\r\n    const result = [];\r\n    for (let p = 0; p < parts.length; p++) {\r\n        const m = parts[p].match(/(\\d+)-(\\d+)/);\r\n        if (m) {\r\n            for (let mm = parseInt(m[1], 10); mm <= parseInt(m[2], 10); mm++) {\r\n                result.push(mm);\r\n            }\r\n        } else {\r\n            result.push(parseInt(parts[p], 10));\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction cron2obj(str, date) {\r\n    const cron = {};\r\n    // date can be 2016-08-07T45:45:35\r\n    if (date) {\r\n        const b = date.split(/\\D/);\r\n        cron.seconds     = [parseInt(b[5], 10)]; // 0 - 59\r\n        cron.minutes     = [parseInt(b[4], 10)]; // 0 - 59\r\n        cron.hours       = [parseInt(b[3], 10)]; // 0 - 23\r\n        cron.dates       = [parseInt(b[2], 10)]; // 1 - 31\r\n        cron.months      = [parseInt(b[1], 10)]; // 1 - 12\r\n        cron.dows        = '?'; // 0 - 6\r\n    } else {\r\n        const parts = str.replace(/\\s\\s/g, ' ').replace(/\\s\\s/g, ' ').split(' ');\r\n        if (parts.length === 6) {\r\n            cron.seconds = oneCron2Array(parts[0]); // 0 - 59\r\n            cron.minutes = oneCron2Array(parts[1]); // 0 - 59\r\n            cron.hours   = oneCron2Array(parts[2]); // 0 - 23\r\n            cron.dates   = oneCron2Array(parts[3]); // 1 - 31\r\n            cron.months  = oneCron2Array(parts[4]); // 1 - 12\r\n            cron.dows    = oneCron2Array(parts[5]); // 0 - 6\r\n        } else {\r\n            cron.seconds = [0];                     // 0 - 59\r\n            cron.minutes = oneCron2Array(parts[0]); // 0 - 59\r\n            cron.hours   = oneCron2Array(parts[1]); // 0 - 23\r\n            cron.dates   = oneCron2Array(parts[2]); // 1 - 31\r\n            cron.months  = oneCron2Array(parts[3]); // 1 - 12\r\n            cron.dows    = oneCron2Array(parts[4]); // 0 - 6\r\n        }\r\n    }\r\n\r\n    return cron;\r\n}\r\n\r\nfunction array2oneCron(obj) {\r\n    if (obj === '*' || obj === '?') return obj;\r\n    if (typeof obj === 'string') obj = parseInt(obj, 10);\r\n    if (typeof obj !== 'object') obj = [obj];\r\n    obj.sort(sortNumbers);\r\n    if (obj.length < 3) return obj.join(',');\r\n\r\n    const newObj = [];\r\n    let start = obj[0];\r\n    let end = obj[0];\r\n\r\n    for (let i = 1; i < obj.length; i++) {\r\n        if (obj[i] === end + 1) {\r\n            end++;\r\n        } else {\r\n            if (start !== end) {\r\n                if (start + 1 === end) {\r\n                    newObj.push(`${start},${end}`);\r\n                } else {\r\n                    newObj.push(`${start}-${end}`);\r\n                }\r\n            } else {\r\n                newObj.push(start);\r\n            }\r\n            start = obj[i];\r\n            end = obj[i];\r\n        }\r\n    }\r\n    if (start !== end) {\r\n        if (start + 1 === end) {\r\n            newObj.push(`${start},${end}`);\r\n        } else {\r\n            newObj.push(`${start}-${end}`);\r\n        }\r\n    } else {\r\n        newObj.push(start);\r\n    }\r\n\r\n    return newObj.join(',');\r\n}\r\n\r\nfunction obj2cron(cron) {\r\n    const parts = ['*', '*', '*', '*', '*', '?'];\r\n    if (cron.seconds) {\r\n        parts[0] = array2oneCron(cron.seconds);\r\n    }\r\n    parts[1] = array2oneCron(cron.minutes);\r\n    parts[2] = array2oneCron(cron.hours);\r\n    parts[3] = array2oneCron(cron.dates);\r\n    parts[4] = array2oneCron(cron.months);\r\n    parts[5] = array2oneCron(cron.dows);\r\n    if (parts[0] === '0') parts.shift();\r\n    return parts.join(' ');\r\n}\r\n\r\nfunction serverDateToClient(dateString, format, serverTimeZone) {\r\n    if (format === 'cron') {\r\n        const cronObject = cron2obj(dateString);\r\n        let date = new Date();\r\n        date.setHours(cronObject.hours[0], cronObject.minutes[0]);\r\n        date = new Date(date.getTime() - (date.getTimezoneOffset() + serverTimeZone) * 60000);\r\n        return date;\r\n    }\r\n    if (format === 'date') {\r\n        dateString += 'Z';\r\n        return new Date(new Date(dateString).getTime() - serverTimeZone * 60000);\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction clientDateToServer(date, format, serverTimeZone) {\r\n    if (format === 'cron') {\r\n        date = new Date(date.getTime() + (date.getTimezoneOffset() + serverTimeZone) * 60000);\r\n        const cronObject = {\r\n            minutes: [date.getMinutes()],\r\n            hours: [date.getHours()],\r\n        };\r\n        return cronObject;\r\n    }\r\n    if (format === 'date') {\r\n        date = new Date(date.getTime() + serverTimeZone * 60000);\r\n        const dateStr = date.toISOString();\r\n        return dateStr.substring(0, dateStr.length - 5);\r\n    }\r\n    return null;\r\n}\r\n\r\nexport {\r\n    cron2obj, obj2cron, serverDateToClient, clientDateToServer,\r\n};\r\n","import {\r\n    Button, Checkbox, Dialog, DialogActions, DialogContent, DialogTitle, FormControl, FormControlLabel, InputAdornment, InputLabel, MenuItem, Select, TextField,\r\n} from '@mui/material';\r\nimport { Cancel, Delete, Save } from '@mui/icons-material';\r\nimport {\r\n    ColorPicker, SelectID, Confirm,\r\n} from '@iobroker/adapter-react-v5';\r\nimport { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { AdapterMoment } from '@mui/x-date-pickers/AdapterMoment';\r\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\r\nimport { TimePicker } from '@mui/x-date-pickers/TimePicker';\r\nimport moment from 'moment';\r\nimport { withStyles } from '@mui/styles';\r\nimport {\r\n    clientDateToServer, cron2obj, obj2cron, serverDateToClient,\r\n} from './Utils';\r\n\r\nconst typeDescriptions = {\r\n    single: 'single_description',\r\n    double: 'double_description',\r\n    toggle: 'toggle_description',\r\n};\r\n\r\nconst styles = {\r\n    field: {\r\n        padding: '2px 0px',\r\n    },\r\n    tableCell: {\r\n        textAlign: 'center',\r\n    },\r\n    typeDescription: {\r\n        fontSize: 12,\r\n        whiteSpace: 'normal',\r\n        fontStyle: 'italic',\r\n    },\r\n    selectId: {\r\n        display: 'flex',\r\n    },\r\n};\r\n\r\nfunction getText(text, lang) {\r\n    if (text && typeof text === 'object') {\r\n        return text[lang] || text.en;\r\n    }\r\n    return text;\r\n}\r\n\r\nconst EventDialog = props => {\r\n    const initialDuration = props.event.native.intervals && props.event.native.intervals[0] && props.event.native.intervals[0].timeOffset ? props.event.native.intervals[0].timeOffset / 60000 : 0;\r\n    const initialEndValue = props.event.native.intervals && props.event.native.intervals[0] && props.event.native.intervals[0].value !== undefined ? props.event.native.intervals[0].value : '';\r\n    const [idDialog, setIdDialog] = useState(false);\r\n    const [event, setEvent] = useState(props.event);\r\n    const [object, setObject] = useState(null);\r\n    const [deleteDialog, setDeleteDialog] = useState(false);\r\n    const [duration, setDuration] = useState(initialDuration);\r\n    const [endValue, setEndValue] = useState(initialEndValue);\r\n\r\n    useEffect(() => {\r\n        if (event.native.oid) {\r\n            props.socket.getObject(event.native.oid)\r\n                .then(obj => setObject(obj))\r\n                .catch(e => {\r\n                    console.error(`Cannot get object ${event.native.oid}: ${e}`);\r\n                    setObject(null);\r\n                });\r\n        } else {\r\n            setObject(null);\r\n        }\r\n    }, [event.native.oid, props.socket]);\r\n\r\n    const cronObject = event.native.cron ? cron2obj(event.native.cron) : null;\r\n    let period = 'once';\r\n    if (Array.isArray(cronObject?.months)) {\r\n        period = 'monthly';\r\n    } else if (Array.isArray(cronObject?.dows)) {\r\n        period = 'daily';\r\n    }\r\n\r\n    let date;\r\n\r\n    if (event) {\r\n        if (period === 'once') {\r\n            date = serverDateToClient(event.native.start, 'date', props.serverTimeZone);\r\n        } else if (period === 'monthly' || period === 'daily') {\r\n            date = serverDateToClient(event.native.cron, 'cron', props.serverTimeZone);\r\n        }\r\n    }\r\n\r\n    const changed = JSON.stringify(props.event) !== JSON.stringify(event) ||\r\n        duration !== initialDuration ||\r\n        endValue !== initialEndValue;\r\n\r\n    const changeEvent = modify => {\r\n        const newEvent = JSON.parse(JSON.stringify(event));\r\n        modify(newEvent);\r\n        setEvent(newEvent);\r\n    };\r\n\r\n    const valueField = (field, name) => {\r\n        if (!object) {\r\n            return null;\r\n        }\r\n        if (object.common.type === 'boolean') {\r\n            return <FormControlLabel\r\n                control={<Checkbox\r\n                    checked={!!event.native[field]}\r\n                    disabled={props.readOnly}\r\n                    onChange={e => {\r\n                        changeEvent(newEvent => newEvent.native[field] = e.target.checked);\r\n                    }}\r\n                />}\r\n                label={props.t(name)}\r\n            />;\r\n        } if (object.common.states) {\r\n            return <FormControl\r\n                fullWidth\r\n                variant=\"standard\"\r\n            >\r\n                <InputLabel>{props.t(name)}</InputLabel>\r\n                <Select\r\n                    value={event.native[field] || ''}\r\n                    disabled={props.readOnly}\r\n                    onChange={e =>\r\n                        changeEvent(newEvent => newEvent.native[field] = e.target.value)}\r\n                >\r\n                    {Object.keys(object.common.states)\r\n                        .map(option => <MenuItem key={option} value={option}>{object.common.states[option]}</MenuItem>)}\r\n                </Select>\r\n            </FormControl>;\r\n        }\r\n        return <TextField\r\n            label={props.t(name)}\r\n            value={event.native[field] || ''}\r\n            disabled={props.readOnly}\r\n            onChange={e => changeEvent(newEvent => newEvent.native[field] = e.target.value)}\r\n            variant=\"standard\"\r\n            fullWidth\r\n        />;\r\n    };\r\n\r\n    const endValueField = () => {\r\n        if (!object) {\r\n            return null;\r\n        }\r\n        if (object.common.type === 'boolean') {\r\n            return <FormControlLabel\r\n                control={<Checkbox\r\n                    checked={!!endValue}\r\n                    disabled={props.readOnly}\r\n                    onChange={e => setEndValue(e.target.checked)}\r\n                />}\r\n                label={props.t('End value')}\r\n            />;\r\n        } if (object.common.states) {\r\n            return <FormControl\r\n                fullWidth\r\n                variant=\"standard\"\r\n            >\r\n                <InputLabel>{props.t('End value')}</InputLabel>\r\n                <Select\r\n                    value={endValue || ''}\r\n                    disabled={props.readOnly}\r\n                    onChange={e => setEndValue(e.target.value)}\r\n                >\r\n                    {Object.keys(object.common.states)\r\n                        .map(option => <MenuItem key={option} value={option}>{object.common.states[option]}</MenuItem>)}\r\n                </Select>\r\n            </FormControl>;\r\n        }\r\n        return <TextField\r\n            label={props.t('End value')}\r\n            value={endValue || ''}\r\n            disabled={props.readOnly}\r\n            onChange={e => setEndValue(e.target.value)}\r\n            variant=\"standard\"\r\n            fullWidth\r\n        />;\r\n    };\r\n\r\n    return <Dialog open={!0} onClose={props.onClose} fullWidth>\r\n        <DialogTitle>{props.t('Configure event')}</DialogTitle>\r\n        <DialogContent>\r\n            {idDialog && <SelectID\r\n                imagePrefix=\"../..\"\r\n                selected={event.native.oid}\r\n                disabled={props.readOnly}\r\n                onOk={id => {\r\n                    changeEvent(newEvent => newEvent.native.oid = id);\r\n                    setIdDialog(false);\r\n                }}\r\n                onClose={() => setIdDialog(false)}\r\n                socket={props.socket}\r\n            />}\r\n            <div className={props.classes.field}>\r\n                <FormControlLabel\r\n                    control={<Checkbox\r\n                        checked={!!event?.common.enabled}\r\n                        disabled={props.readOnly}\r\n                        onChange={e =>\r\n                            changeEvent(newEvent => newEvent.common.enabled = e.target.checked)}\r\n                    />}\r\n                    label={props.t('Active')}\r\n                />\r\n            </div>\r\n            <div className={props.classes.field}>\r\n                <FormControl\r\n                    fullWidth\r\n                    variant=\"standard\"\r\n                >\r\n                    <InputLabel>{props.t('Event type')}</InputLabel>\r\n                    <Select\r\n                        value={event.native.type || ''}\r\n                        disabled={props.readOnly}\r\n                        onChange={e =>\r\n                            changeEvent(newEvent => newEvent.native.type = e.target.value)}\r\n                        renderValue={value => props.t(value)}\r\n                    >\r\n                        {['single', 'double', 'toggle'].map(type =>\r\n                            <MenuItem key={type} value={type}>\r\n                                <div>\r\n                                    <div>{props.t(type)}</div>\r\n                                    <div className={props.classes.typeDescription}>{props.t(typeDescriptions[type])}</div>\r\n                                </div>\r\n                            </MenuItem>)}\r\n                    </Select>\r\n                </FormControl>\r\n            </div>\r\n            <div className={props.classes.field}>\r\n                <LocalizationProvider dateAdapter={AdapterMoment}>\r\n                    <TimePicker\r\n                        label={props.t('Time')}\r\n                        value={date || null}\r\n                        disabled={props.readOnly}\r\n                        onChange={_date => {\r\n                            if (!_date) {\r\n                                return;\r\n                            }\r\n                            try {\r\n                                changeEvent(newEvent => {\r\n                                    if (period === 'once') {\r\n                                        newEvent.native.start = clientDateToServer(_date.toDate(), 'date', props.serverTimeZone);\r\n                                    } else if (period === 'monthly' || period === 'daily') {\r\n                                        const newCron = cron2obj(newEvent.native.cron);\r\n                                        const timeZoneCron = clientDateToServer(_date.toDate(), 'cron', props.serverTimeZone);\r\n                                        newCron.hours = timeZoneCron.hours;\r\n                                        newCron.minutes = timeZoneCron.minutes;\r\n                                        newEvent.native.cron = obj2cron(newCron);\r\n                                    }\r\n                                });\r\n                            } catch {\r\n                                //\r\n                            }\r\n                        }}\r\n                        renderInput={params => <TextField {...params} variant=\"standard\" fullWidth />}\r\n                        ampm={false}\r\n                    />\r\n                </LocalizationProvider>\r\n            </div>\r\n            {event.native.type !== 'single' && <div className={props.classes.field}>\r\n                <TextField\r\n                    label={props.t('Duration')}\r\n                    value={duration}\r\n                    disabled={props.readOnly}\r\n                    onChange={e => setDuration(e.target.value)}\r\n                    variant=\"standard\"\r\n                    fullWidth\r\n                    InputProps={{\r\n                        endAdornment: <InputAdornment position=\"end\">{props.t('minutes')}</InputAdornment>,\r\n                    }}\r\n                />\r\n            </div>}\r\n            <div className={props.classes.field}>\r\n                <div className={props.classes.selectId}>\r\n                    <TextField\r\n                        label=\"Object ID\"\r\n                        value={event.native.oid || ''}\r\n                        disabled={props.readOnly}\r\n                        onChange={e => changeEvent(newEvent => newEvent.native.oid = e.target.value)}\r\n                        variant=\"standard\"\r\n                        helperText={getText(object?.common.name || '', props.language)}\r\n                        fullWidth\r\n                    />\r\n                    <Button onClick={() => setIdDialog(true)}>...</Button>\r\n                </div>\r\n            </div>\r\n            <div className={props.classes.field}>\r\n                {valueField('startValue', event.native.type === 'toggle' ? 'First value' : 'Start value')}\r\n            </div>\r\n            {event.native.type === 'double' && <div className={props.classes.field}>\r\n                {endValueField()}\r\n            </div>}\r\n            <div className={props.classes.field}>\r\n                <FormControl\r\n                    fullWidth\r\n                    variant=\"standard\"\r\n                >\r\n                    <InputLabel>{props.t('Period')}</InputLabel>\r\n                    <Select\r\n                        value={period || 'once'}\r\n                        disabled={props.readOnly}\r\n                        onChange={e => {\r\n                            if (e.target.value === event.native.cron) {\r\n                                return;\r\n                            }\r\n                            changeEvent(newEvent => {\r\n                                if (e.target.value === 'once') {\r\n                                    delete newEvent.native.cron;\r\n                                    newEvent.native.start = clientDateToServer(date, 'date', props.serverTimeZone);\r\n                                } else if (e.target.value === 'daily') {\r\n                                    delete newEvent.native.start;\r\n                                    const newCronObject = cron2obj('0 0 ? * 0-6');\r\n                                    const timeZoneCron = clientDateToServer(date, 'cron', props.serverTimeZone);\r\n                                    newCronObject.hours = timeZoneCron.hours;\r\n                                    newCronObject.minutes = timeZoneCron.minutes;\r\n                                    newEvent.native.cron = obj2cron(newCronObject);\r\n                                } else if (e.target.value === 'monthly') {\r\n                                    delete newEvent.native.start;\r\n                                    const newCronObject = cron2obj('0 0 ? 1-12 ?');\r\n                                    const timeZoneCron = clientDateToServer(date, 'cron', props.serverTimeZone);\r\n                                    newCronObject.hours = timeZoneCron.hours;\r\n                                    newCronObject.minutes = timeZoneCron.minutes;\r\n                                    newEvent.native.cron = obj2cron(newCronObject);\r\n                                }\r\n                            });\r\n                        }}\r\n                    >\r\n                        {['once', 'daily', 'monthly'].map(type => <MenuItem key={type} value={type}>{props.t(type)}</MenuItem>)}\r\n                    </Select>\r\n                </FormControl>\r\n            </div>\r\n            {period === 'monthly' && <div className={props.classes.field}>\r\n                <table>\r\n                    <tr>\r\n                        {new Array(12).fill(null).map((value, i) => <td\r\n                            className={props.classes.tableCell}\r\n                        >\r\n                            {moment().month(i).format('MMM')}\r\n                        </td>)}\r\n                    </tr>\r\n                    <tr>\r\n                        {new Array(12).fill(null).map((value, i) => <td>\r\n                            <Checkbox\r\n                                checked={cronObject?.months?.includes(i + 1) || false}\r\n                                disabled={props.readOnly}\r\n                                onChange={e => {\r\n                                    changeEvent(newEvent => {\r\n                                        const newCronObject = cron2obj(newEvent.native.cron);\r\n                                        if (e.target.checked) {\r\n                                            newCronObject.months.push(i + 1);\r\n                                        } else {\r\n                                            newCronObject.months = newCronObject.months.filter(month => month !== i + 1);\r\n                                        }\r\n                                        newEvent.native.cron = obj2cron(newCronObject);\r\n                                    });\r\n                                }}\r\n                                size=\"small\"\r\n                            />\r\n                        </td>)}\r\n                    </tr>\r\n                </table>\r\n            </div>}\r\n            {period === 'daily' && <div className={props.classes.field}>\r\n                <table>\r\n                    <tr>\r\n                        {new Array(7).fill(null).map((value, i) => <td\r\n                            className={props.classes.tableCell}\r\n                        >\r\n                            {moment().day(i).format('ddd')}\r\n                        </td>)}\r\n                    </tr>\r\n                    <tr>\r\n                        {new Array(7).fill(null).map((value, i) => <td>\r\n                            <Checkbox\r\n                                checked={cronObject?.dows?.includes(i) || false}\r\n                                disabled={props.readOnly}\r\n                                onChange={e => {\r\n                                    changeEvent(newEvent => {\r\n                                        const newCronObject = cron2obj(newEvent.native.cron);\r\n                                        if (e.target.checked) {\r\n                                            newCronObject.dows.push(i);\r\n                                        } else {\r\n                                            newCronObject.dows = newCronObject.dows.filter(dow => dow !== i);\r\n                                        }\r\n                                        newEvent.native.cron = obj2cron(newCronObject);\r\n                                    });\r\n                                }}\r\n                                size=\"small\"\r\n                            />\r\n                        </td>)}\r\n                    </tr>\r\n                </table>\r\n            </div>}\r\n            <div className={props.classes.field}>\r\n                <TextField\r\n                    label=\"Description\"\r\n                    value={event?.common.name || ''}\r\n                    disabled={props.readOnly}\r\n                    onChange={e =>\r\n                        changeEvent(newEvent => newEvent.common.name = e.target.value)}\r\n                    variant=\"standard\"\r\n                    fullWidth\r\n                />\r\n            </div>\r\n            <div className={props.classes.field}>\r\n                <ColorPicker\r\n                    value={event.native.color || ''}\r\n                    disabled={props.readOnly}\r\n                    onChange={color =>\r\n                        changeEvent(newEvent => newEvent.native.color = color)}\r\n                    name={props.t('Color')}\r\n                />\r\n            </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n            {!props.readOnly ? <Button\r\n                variant=\"contained\"\r\n                color=\"secondary\"\r\n                startIcon={<Delete />}\r\n                onClick={() => setDeleteDialog(true)}\r\n            >\r\n                {props.t('Delete')}\r\n            </Button> : null}\r\n            {!props.readOnly && !props.widget ? <div style={{ flex: 1 }} /> : null}\r\n            {!props.readOnly ? <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                disabled={!changed}\r\n                startIcon={<Save />}\r\n                onClick={async () => {\r\n                    if (event.native.type === 'single') {\r\n                        if (event.native.intervals) {\r\n                            delete event.native.intervals;\r\n                        }\r\n                    } else if (event.native.type === 'double') {\r\n                        event.native.intervals = event.native.intervals || [];\r\n                        event.native.intervals[0] = event.native.intervals[0] || {};\r\n                        event.native.intervals[0].timeOffset = (parseFloat(duration) || 1) * 60000;\r\n                        event.native.intervals[0].value = endValue;\r\n                    } else if (event.native.type === 'toggle') {\r\n                        event.native.intervals = event.native.intervals || [];\r\n                        event.native.intervals[0] = event.native.intervals[0] || {};\r\n                        event.native.intervals[0].timeOffset = (parseFloat(duration) || 1) * 60000;\r\n                    }\r\n\r\n                    await props.socket.setObject(event._id, event);\r\n                    props.updateEvents();\r\n                    props.onClose();\r\n                }}\r\n            >\r\n                {props.t('Save')}\r\n            </Button> : null}\r\n            <Button\r\n                variant=\"contained\"\r\n                color=\"grey\"\r\n                startIcon={<Cancel />}\r\n                onClick={props.onClose}\r\n            >\r\n                {props.readOnly ? props.t('Close') : props.t('Cancel')}\r\n            </Button>\r\n        </DialogActions>\r\n        {deleteDialog && <Confirm\r\n            title={props.t('Delete event')}\r\n            text={props.t('Event will be deleted. Confirm?')}\r\n            suppressQuestionMinutes={5}\r\n            dialogName=\"deleteConfirmDialog\"\r\n            onClose={async isYes => {\r\n                if (isYes) {\r\n                    try {\r\n                        await props.socket.delObject(event._id);\r\n                        props.updateEvents();\r\n                    } catch (e) {\r\n                        window.alert(`Cannot delete event: ${e}`);\r\n                    }\r\n\r\n                    props.onClose();\r\n                }\r\n                setDeleteDialog(false);\r\n            }}\r\n        />}\r\n    </Dialog>;\r\n};\r\n\r\nEventDialog.propTypes = {\r\n    classes: PropTypes.object.isRequired,\r\n    socket: PropTypes.object.isRequired,\r\n    onClose: PropTypes.func.isRequired,\r\n    event: PropTypes.object,\r\n    readOnly: PropTypes.bool,\r\n    updateEvents: PropTypes.func.isRequired,\r\n    serverTimeZone: PropTypes.number.isRequired,\r\n    t: PropTypes.func.isRequired,\r\n    language: PropTypes.string.isRequired,\r\n    widget: PropTypes.bool,\r\n};\r\n\r\nexport default withStyles(styles)(EventDialog);\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { withStyles, withTheme } from '@mui/styles';\r\n\r\nimport FullCalendar from '@fullcalendar/react';\r\nimport dayGridPlugin from '@fullcalendar/daygrid';\r\nimport timeGridPlugin from '@fullcalendar/timegrid';\r\nimport interactionPlugin, { Draggable } from '@fullcalendar/interaction';\r\nimport rrulePlugin from '@fullcalendar/rrule';\r\nimport listPlugin from '@fullcalendar/list';\r\nimport deLocale from '@fullcalendar/core/locales/de';\r\nimport ruLocale from '@fullcalendar/core/locales/ru';\r\nimport ptLocale from '@fullcalendar/core/locales/pt';\r\nimport nlLocale from '@fullcalendar/core/locales/nl';\r\nimport frLocale from '@fullcalendar/core/locales/fr';\r\nimport itLocale from '@fullcalendar/core/locales/it';\r\nimport esLocale from '@fullcalendar/core/locales/es';\r\nimport plLocale from '@fullcalendar/core/locales/pl';\r\nimport ukLocale from '@fullcalendar/core/locales/uk';\r\nimport zhCnLocale from '@fullcalendar/core/locales/zh-cn';\r\n\r\nimport { Paper } from '@mui/material';\r\n\r\nimport {\r\n    clientDateToServer, cron2obj, obj2cron, serverDateToClient,\r\n} from './Utils';\r\nimport EventDialog from './EventDialog';\r\n\r\nconst eventTypes = [\r\n    { type: 'single', name: 'Single event' },\r\n    { type: 'double', name: 'Double event' },\r\n    { type: 'toggle', name: 'Toggle event' },\r\n];\r\n\r\nconst DraggableButton = ({ type, t }) => {\r\n    const ref = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const draggable = new Draggable(ref.current, {\r\n            eventData: () => ({\r\n                id: type.type,\r\n                title: t(type.name),\r\n                create: true,\r\n                extendedProps: {\r\n                    type: type.type,\r\n                },\r\n            }),\r\n        });\r\n        return () => {\r\n            draggable.destroy();\r\n        };\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    return <div\r\n        style={{\r\n            backgroundColor: 'rgb(58, 135, 178)',\r\n            color: 'white',\r\n            cursor: 'pointer',\r\n            fontSize: '14px',\r\n            padding: '3px 4px 6px 8px',\r\n            borderRadius: 4,\r\n            marginBottom: 20,\r\n        }}\r\n        ref={ref}\r\n    >\r\n        {t(type.name)}\r\n    </div>;\r\n};\r\n\r\nconst styles = () => ({\r\n    container: {\r\n        display: 'flex',\r\n        height: '100%',\r\n        width: '100%',\r\n    },\r\n    leftBlock: {\r\n        width: 200,\r\n    },\r\n    calendarBlock: {\r\n        flex: 1,\r\n        display: 'flex',\r\n    },\r\n    calendar: {\r\n        // height: '80%',\r\n        marginRight: 20,\r\n        width: '100%',\r\n    },\r\n    leftPaper: {\r\n        margin: 20,\r\n    },\r\n    leftContent: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        padding: '20px 10px',\r\n    },\r\n    hr: {\r\n        width: '100%',\r\n    },\r\n});\r\n\r\nfunction dimColor(color) {\r\n    if (color.startsWith('#')) {\r\n        if (color.length === 4) {\r\n            return `#${color[1]}${color[1]}${color[2]}${color[2]}${color[3]}${color[3]}50`;\r\n        }\r\n        return `${color.substring(0, 7)}50`;\r\n    }\r\n    if (color.startsWith('rgb(')) {\r\n        return color.replace('rgb(', 'rgba(').replace(')', ', 0.3)');\r\n    }\r\n    if (color.startsWith('rgba(')) {\r\n        return color.replace(/,\\s?[.\\d]+\\)$/, ', 0.3)');\r\n    }\r\n    return color;\r\n}\r\n\r\nfunction Calendar(props) {\r\n    const [eventDialog, setEventDialog] = useState(null);\r\n    const storageName = props.storageName || 'calendar';\r\n    const ref = useRef(null);\r\n    const scrollBackTimer = useRef(null);\r\n    const scrollTimer = useRef(null);\r\n\r\n    const initialDate = !props.widget && window.localStorage.getItem(`${storageName}Start`) ?\r\n        new Date(parseInt(window.localStorage.getItem(`${storageName}Start`), 10)) :\r\n        new Date();\r\n\r\n    // create events\r\n    const events = props.events.map(event => {\r\n        // duration in ms\r\n        const initialDuration = event?.native?.intervals && event.native.intervals[0] && event.native.intervals[0].timeOffset ? event.native.intervals[0].timeOffset : 0;\r\n\r\n        if (event.native.cron) {\r\n            const start = serverDateToClient(event.native.cron, 'cron', props.serverTimeZone);\r\n            const cronObject = cron2obj(event.native.cron);\r\n            start.setFullYear(1970);\r\n            if (Array.isArray(cronObject.months)) {\r\n                return {\r\n                    id: event._id,\r\n                    title: event.common.name,\r\n                    backgroundColor: event.native.color,\r\n                    start,\r\n                    duration: initialDuration,\r\n                    allDay: false,\r\n                    rrule: {\r\n                        dtstart: new Date(start.getTime() - start.getTimezoneOffset() * 60000),\r\n                        freq: 'daily',\r\n                        bymonth: cronObject.months,\r\n                    },\r\n                };\r\n            }\r\n            if (Array.isArray(cronObject.dows)) {\r\n                return {\r\n                    id: event._id,\r\n                    title: event.common.name,\r\n                    backgroundColor: event.native.color,\r\n                    start,\r\n                    duration: initialDuration,\r\n                    allDay: false,\r\n                    display: 'block',\r\n                    rrule: {\r\n                        dtstart: new Date(start.getTime() - start.getTimezoneOffset() * 60000),\r\n                        freq: 'weekly',\r\n                        byweekday: cronObject.dows.map(dow => (dow === 0 ? 6 : dow - 1)),\r\n                    },\r\n                };\r\n            }\r\n            return {\r\n                id: event._id,\r\n                title: event.common.name,\r\n                backgroundColor: event.native.color,\r\n            };\r\n        }\r\n\r\n        return {\r\n            id: event._id,\r\n            title: event.common.name,\r\n            display: 'block',\r\n            backgroundColor: event.common.enabled ? event.native.color : dimColor(event.native.color),\r\n            start: serverDateToClient(event.native.start, 'date', props.serverTimeZone),\r\n            end: serverDateToClient(new Date(new Date(event.native.start).getTime() + initialDuration), 'date', props.serverTimeZone),\r\n        };\r\n    });\r\n\r\n    useEffect(() => {\r\n        // update periodically the time\r\n        if (props.widget) {\r\n            const scrollBack = () => {\r\n                const calendar = ref.current?.getApi();\r\n                if (calendar) {\r\n                    console.log('Scroll to now');\r\n                    calendar.scrollToTime(new Date().getTime());\r\n                }\r\n                if (!scrollBackTimer.current) {\r\n                    scrollTimer.current = setTimeout(() => scrollBack, 1000 * 60 * 5); // 5 minutes\r\n                } else {\r\n                    scrollTimer.current = null;\r\n                }\r\n            };\r\n\r\n            setTimeout(scrollBack, 1000);\r\n        }\r\n\r\n        return () => {\r\n            scrollTimer.current && clearTimeout(scrollTimer.current);\r\n            scrollTimer.current = null;\r\n            scrollBackTimer.current && clearTimeout(scrollBackTimer.current);\r\n            scrollBackTimer.current = null;\r\n        };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    return <>\r\n        <style>\r\n            {props.theme.palette.mode === 'dark' ? `\r\n:root {\r\n    --fc-neutral-bg-color: hsla(0,0%,12%);\r\n    --fc-list-event-hover-bg-color: hsla(0,0%,12%);\r\n}\r\n.fc-col-header-cell {\r\n    background-color: #1e1e1e;\r\n}                \r\n` : `\r\n.fc-col-header-cell {\r\n    background-color: #EEEEEE;\r\n}\r\n`}\r\n        </style>\r\n        {eventDialog ? <EventDialog\r\n            widget={props.widget}\r\n            event={props.events.find(event => event._id === eventDialog)}\r\n            onClose={() => setEventDialog(null)}\r\n            socket={props.socket}\r\n            updateEvents={props.updateEvents}\r\n            serverTimeZone={props.serverTimeZone}\r\n            readOnly={props.readOnly}\r\n            t={props.t}\r\n            language={props.language}\r\n        /> : null}\r\n        <div className={props.classes.container}>\r\n            {!props.hideLeftBlock && !props.readOnly && <div className={props.classes.leftBlock}>\r\n                <Paper elevation={4} className={props.classes.leftPaper}>\r\n                    <div className={props.classes.leftContent}>\r\n                        <h4>{props.t('Events')}</h4>\r\n                        {eventTypes.map((type, index) =>\r\n                            <DraggableButton\r\n                                t={props.t}\r\n                                type={type}\r\n                                name={props.t(type.name)}\r\n                                key={type.type}\r\n                                index={index}\r\n                            />)}\r\n                        {props.hideLeftBlockHint ? null : <div>{props.t('Drag and drop the events above to create a new one.')}</div>}\r\n                        {props.hideLeftBlockHint ? null : <hr className={props.classes.hr} />}\r\n                        {props.hideLeftBlockHint ? null : <div>{props.t('Use ALT by dragging it to copy the events.')}</div>}\r\n                    </div>\r\n                </Paper>\r\n            </div>}\r\n            <div className={props.classes.calendarBlock}>\r\n                <div className={props.classes.calendar}>\r\n                    <FullCalendar\r\n                        ref={ref}\r\n                        plugins={[listPlugin, dayGridPlugin, timeGridPlugin, interactionPlugin, rrulePlugin]}\r\n                        weekends={!props.hideWeekends}\r\n                        headerToolbar={\r\n                            props.hideTopBlock ? false :\r\n                                {\r\n                                    left: props.hideTopBlockButtons ? '' : 'prev,next today',\r\n                                    center: 'title',\r\n                                    right: props.hideTopBlockButtons ? '' : 'dayGridMonth,timeGridWeek,timeGridDay,listMonth',\r\n                                }\r\n                        }\r\n                        initialView={props.viewMode || window.localStorage.getItem(`${storageName}View`) || 'dayGridMonth'}\r\n                        initialDate={initialDate}\r\n                        editable={!props.readOnly}\r\n                        selectable\r\n                        selectMirror\r\n                        dayMaxEvents\r\n                        events={events}\r\n                        height=\"calc(100% - 20px)\"\r\n                        locales={[\r\n                            deLocale,\r\n                            ruLocale,\r\n                            ptLocale,\r\n                            nlLocale,\r\n                            frLocale,\r\n                            itLocale,\r\n                            esLocale,\r\n                            plLocale,\r\n                            ukLocale,\r\n                            zhCnLocale,\r\n                        ]}\r\n                        locale={props.language}\r\n                        datesSet={date => {\r\n                            if (!props.widget) {\r\n                                window.localStorage.setItem(`${storageName}Start`, date.view.currentStart.getTime());\r\n                                window.localStorage.setItem(`${storageName}View`, date.view.type);\r\n                            } else {\r\n                                scrollTimer.current && clearTimeout(scrollTimer.current);\r\n                                scrollTimer.current = null;\r\n\r\n                                scrollBackTimer.current && clearTimeout(scrollBackTimer.current);\r\n                                scrollBackTimer.current = setTimeout(() => {\r\n                                    scrollBackTimer.current = null;\r\n\r\n                                    const scrollBack = () => {\r\n                                        const calendar = ref.current?.getApi();\r\n                                        calendar?.scrollToTime(new Date().getTime());\r\n                                        if (!scrollBackTimer.current) {\r\n                                            scrollTimer.current = setTimeout(() => scrollBack, 1000 * 60 * 5); // 5 minutes\r\n                                        } else {\r\n                                            scrollTimer.current = null;\r\n                                        }\r\n                                    };\r\n\r\n                                    scrollBack();\r\n                                }, 60000);\r\n                            }\r\n                        }}\r\n                        // select={this.handleDateSelect}\r\n                        // eventContent={event => <MenuItem>\r\n                        //     {event.event.title}\r\n                        // </MenuItem>}\r\n                        eventClick={event => setEventDialog(event.event.id)}\r\n                        eventResize={event => {\r\n                            const eventData = props.events.find(_event => _event._id === event.event.id);\r\n                            if (eventData.native.intervals?.[0].timeOffset) {\r\n                                const newEvent = JSON.parse(JSON.stringify(eventData));\r\n                                newEvent.native.intervals[0].timeOffset += event.endDelta.milliseconds;\r\n                                props.socket.setObject(newEvent._id, newEvent);\r\n                                props.updateEvents();\r\n                            } else {\r\n                                event.revert();\r\n                            }\r\n                        }}\r\n                        eventDrop={async event => {\r\n                            const eventData = props.events.find(_event => _event._id === event.event.id);\r\n                            if (eventData?.native?.cron) {\r\n                                const newEvent = JSON.parse(JSON.stringify(eventData));\r\n                                if (event.jsEvent.altKey) {\r\n                                    newEvent._id = `fullcalendar.${props.instance}.event-${uuidv4()}`;\r\n                                }\r\n                                const newCron = cron2obj(newEvent.native.cron);\r\n                                const timeZoneCron = clientDateToServer(event.event.start, 'cron', props.serverTimeZone);\r\n                                newCron.hours = timeZoneCron.hours;\r\n                                newCron.minutes = timeZoneCron.minutes;\r\n                                newEvent.native.cron = obj2cron(newCron);\r\n                                await props.socket.setObject(newEvent._id, newEvent);\r\n                                props.updateEvents();\r\n                            } else {\r\n                                const newEvent = JSON.parse(JSON.stringify(eventData));\r\n                                if (event.jsEvent.altKey) {\r\n                                    newEvent._id = `fullcalendar.${props.instance}.event-${uuidv4()}`;\r\n                                }\r\n                                newEvent.native.start = clientDateToServer(event.event.start, 'date', props.serverTimeZone);\r\n                                await props.socket.setObject(newEvent._id, newEvent);\r\n                                props.updateEvents();\r\n                            }\r\n                        }}\r\n                        eventReceive={async event => {\r\n                            const newEvent = {\r\n                                _id: `fullcalendar.${props.instance}.event-${uuidv4()}`,\r\n                                common: {\r\n                                    name: event.event.title,\r\n                                    enabled: true,\r\n                                },\r\n                                native: {\r\n                                    id: Date.now(),\r\n                                    start: clientDateToServer(event.event.start, 'date', props.serverTimeZone),\r\n                                    type: event.event.extendedProps.type,\r\n                                    durationEditable: false,\r\n                                    oid: '',\r\n                                    startValue: '',\r\n                                    color: '#3A87AD',\r\n                                },\r\n                                type: 'schedule',\r\n                            };\r\n                            if (event.event.extendedProps.type !== 'single') {\r\n                                newEvent.native.intervals = [{\r\n                                    timeOffset: 30 * 60 * 1000,\r\n                                }];\r\n                            }\r\n                            await props.socket.setObject(newEvent._id, newEvent);\r\n                            props.updateEvents();\r\n                            setTimeout(() => setEventDialog(newEvent._id), 100);\r\n                        }}\r\n                        select={async selectInfo => {\r\n                            const calendarApi = selectInfo.view.calendar;\r\n                            calendarApi.unselect(); // clear date selection\r\n\r\n                            if (props.readOnly) {\r\n                                return;\r\n                            }\r\n                            console.log('ADD', selectInfo);\r\n\r\n                            const newEvent = {\r\n                                _id: `fullcalendar.${props.instance}.event-${uuidv4()}`,\r\n                                common: {\r\n                                    name: props.t('Single event'),\r\n                                    enabled: true,\r\n                                },\r\n                                native: {\r\n                                    id: Date.now(),\r\n                                    start: clientDateToServer(selectInfo.date || selectInfo.start, 'date', props.serverTimeZone),\r\n                                    intervals: selectInfo.end ? [{\r\n                                        value: '',\r\n                                        timeOffset: (selectInfo.end.getTime() - selectInfo.start.getTime()),\r\n                                    }] : undefined,\r\n                                    type: selectInfo.end ? 'double' : 'single',\r\n                                    durationEditable: !!selectInfo.end,\r\n                                    oid: '',\r\n                                    startValue: '',\r\n                                    color: '#3A87AD',\r\n                                },\r\n                                type: 'schedule',\r\n                            };\r\n                            await props.socket.setObject(newEvent._id, newEvent);\r\n                            await props.updateEvents();\r\n                            setTimeout(() => setEventDialog(newEvent._id), 100);\r\n                        }}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </>;\r\n}\r\n\r\nCalendar.propTypes = {\r\n    events: PropTypes.array,\r\n    serverTimeZone: PropTypes.number,\r\n    theme: PropTypes.object,\r\n    socket: PropTypes.object,\r\n    readOnly: PropTypes.bool,\r\n    hideLeftBlock: PropTypes.bool,\r\n    hideTopBlock: PropTypes.bool,\r\n    hideLeftBlockHint: PropTypes.bool,\r\n    hideTopBlockButtons: PropTypes.bool,\r\n    hideWeekends: PropTypes.bool,\r\n    viewMode: PropTypes.bool,\r\n    updateEvents: PropTypes.func,\r\n    instance: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n    t: PropTypes.func.isRequired,\r\n    widget: PropTypes.bool,\r\n    language: PropTypes.string.isRequired,\r\n    storageName: PropTypes.string,\r\n};\r\n\r\nexport default withTheme(withStyles(styles)(Calendar));\r\n"],"names":["sortNumbers","a","b","oneCron2Array","str","parts","result","p","mm","cron2obj","date","cron","array2oneCron","obj","newObj","start","end","i","obj2cron","serverDateToClient","dateString","format","serverTimeZone","cronObject","clientDateToServer","dateStr","typeDescriptions","styles","getText","text","lang","EventDialog","props","initialDuration","initialEndValue","idDialog","setIdDialog","event","setEvent","object","setObject","deleteDialog","setDeleteDialog","duration","setDuration","endValue","setEndValue","e","period","changed","changeEvent","modify","newEvent","valueField","field","name","option","endValueField","id","value","type","LocalizationProvider","TimePicker","_date","newCron","timeZoneCron","params","newCronObject","month","dow","color","isYes","eventTypes","DraggableButton","t","ref","draggable","dimColor","Calendar","eventDialog","setEventDialog","storageName","scrollBackTimer","scrollTimer","initialDate","events","scrollBack","calendar","index","list","interaction","rrule","de","ru","pt","nl","fr","it","es","pl","uk","eventData","_event","selectInfo"],"sourceRoot":""}