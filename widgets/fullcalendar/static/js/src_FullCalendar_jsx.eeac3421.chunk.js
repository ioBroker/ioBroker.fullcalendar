"use strict";(self.webpackChunkiobroker_vis_2_widgets_fullcalendar=self.webpackChunkiobroker_vis_2_widgets_fullcalendar||[]).push([["src_FullCalendar_jsx"],{4278:function(B,E,a){a.r(E);var y=a(4819),c=a.n(y),g=a(15854),d=a.n(g),h=a(58503),x=a.n(h),_=a(94427),W=a.n(_),u=a(75606),T=a.n(u),D=a(88411),L=a.n(D),b=a(83178),O=Object.defineProperty,M=(n,e,t)=>e in n?O(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,f=(n,e,t)=>(M(n,typeof e!="symbol"?e+"":e,t),t),P=(n,e,t)=>new Promise((s,l)=>{var r=i=>{try{p(t.next(i))}catch(m){l(m)}},v=i=>{try{p(t.throw(i))}catch(m){l(m)}},p=i=>i.done?s(i.value):Promise.resolve(i.value).then(r,v);p((t=t.apply(n,e)).next())});const C=()=>({content:{display:"flex",width:"100%",height:"100%",overflow:"auto"}}),k=window.visRxWidget||D.VisRxWidget;class o extends k{constructor(e){super(e),f(this,"onEventsChanged",(t,s)=>{const l=JSON.parse(JSON.stringify(this.state.events)),r=l.findIndex(v=>v._id===t);r!==-1?s?l[r]=s:l.splice(r,1):l.push(s),this.setState({events:l})}),f(this,"updateEvents",()=>P(this,null,function*(){const t=yield this.props.socket.getObjectViewCustom("schedule","schedule",`fullcalendar.${this.state.rxData.instance}.`,`fullcalendar.${this.state.rxData.instance}.\u9999`);let s=0;try{const l=yield this.props.socket.getState("fullcalendar.0.info.timeZone");s=(l==null?void 0:l.val)||0}catch(l){}this.setState({events:Object.values(t),serverTimeZone:s})})),f(this,"changeEvents",t=>{this.setState({events:t})}),this.widgetRef=c().createRef()}static getWidgetInfo(){return{id:"tplFullCalendar",visSet:"fullcalendar",visWidgetLabel:"fullcalendar",visSetLabel:"set_label",visSetColor:"#112233",visName:"Full calendar",visAttrs:[{name:"common",fields:[{label:"instance",name:"instance",type:"instance",adapter:"fullcalendar",isShort:!0},{label:"read_only",name:"readOnly",type:"checkbox",default:!1},{label:"hide_left_block",name:"hideLeftBlock",type:"checkbox",hidden:e=>e.readOnly,default:!1},{label:"hide_left_block_hint",name:"hideLeftBlockHint",type:"checkbox",hidden:e=>e.readOnly||e.hideLeftBlock,default:!1},{label:"hide_top_block",name:"hideTopBlock",type:"checkbox",default:!1},{label:"hide_top_block_buttons",name:"hideTopBlockButtons",type:"checkbox",hidden:e=>e.hide_top_block,default:!1},{label:"hide_weekends",name:"hideWeekends",type:"checkbox",default:!1},{label:"view_mode",name:"viewMode",type:"select",options:[{label:"full_calendar_dayGridMonth",value:"dayGridMonth"},{label:"full_calendar_timeGridWeek",value:"timeGridWeek"},{label:"full_calendar_timeGridDay",value:"timeGridDay"},{label:"full_calendar_listMonth",value:"listMonth"}],default:"dayGridMonth"},{label:"name",name:"name",tooltip:"used_only_with_relative",default:"",hidden:(e,t,s)=>s&&s.position!=="relative"}]}],visDefaultStyle:{width:"100%",height:355,position:"relative"},visPrev:"widgets/fullcalendar/img/prev_fullcalendar.png"}}static t(e,...t){return u.I18n.t(`full_calendar_${e}`,...t)}getWidgetInfo(){return o.getWidgetInfo()}componentDidMount(){super.componentDidMount(),this.props.socket.subscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),this.updateEvents()}componentWillUnmount(){this.props.socket.unsubscribeObject(`fullcalendar.${this.state.rxData.instance}.*`,this.onEventsChanged),super.componentWillUnmount()}onRxDataChanged(){this.updateEvents()}renderWidgetBody(e){var t;super.renderWidgetBody(e),(t=this.widgetRef.current)!=null&&t.offsetWidth||this.forceUpdate();const s=c().createElement("div",{className:this.props.classes.content,ref:this.widgetRef},c().createElement(b.Z,{widget:!0,key:this.state.rxData.viewMode,events:this.state.events||[],socket:this.props.socket,instance:this.state.rxData.instance,changeEvents:this.changeEvents,updateEvents:this.updateEvents,serverTimeZone:this.state.serverTimeZone||0,readOnly:this.state.rxData.readOnly||!1,hideLeftBlock:this.state.rxData.hideLeftBlock||!1,hideTopBlock:this.state.rxData.hideTopBlock||!1,hideLeftBlockHint:this.state.rxData.hideLeftBlockHint||!1,hideTopBlockButtons:this.state.rxData.hideTopBlockButtons||!1,viewMode:this.state.rxData.viewMode||null,storageName:`fc_${this.props.id}`,hideWeekends:this.state.rxData.hideWeekends||!1,t:o.t,language:u.I18n.getLanguage()}));return this.state.rxStyle.position==="relative"?this.wrapContent(s,null,{height:"calc(100% - 24px)",width:"calc(100% - 24px)"},null,null,{Card:_.Card,CardContent:_.CardContent}):s}}o.propTypes={systemConfig:d().object,socket:d().object,themeType:d().string,style:d().object,data:d().object},E.default=(0,h.withStyles)(C)((0,h.withTheme)(o))}}]);

//# sourceMappingURL=src_FullCalendar_jsx.eeac3421.chunk.js.map