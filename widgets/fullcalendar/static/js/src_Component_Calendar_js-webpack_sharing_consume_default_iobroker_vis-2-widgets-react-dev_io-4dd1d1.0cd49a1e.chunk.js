"use strict";(self.webpackChunkiobroker_vis_2_widgets_fullcalendar=self.webpackChunkiobroker_vis_2_widgets_fullcalendar||[]).push([["src_Component_Calendar_js-webpack_sharing_consume_default_iobroker_vis-2-widgets-react-dev_io-4dd1d1"],{83178:function(ze,ae,c){c.d(ae,{Z:function(){return Ve}});var w=c(4819),le=c(15854),u=c.n(le),M=c(10651),G=c(58503),ie=c(76516),re=c(40387),se=c(24990),U=c(44251),oe=c(33634),de=c(51172),ce=c(25177),ue=c(33841),me=c(49582),ve=c(36513),fe=c(4302),ge=c(43007),ye=c(43223),he=c(96933),Ee=c(93484),Ce=c(80809),o=c(94427),j=c(75606),J=c(14853),be=c(98667),Q=c.n(be);function Te(e,r){return e-r}function I(e){if(e==="*"||e==="?"||e==="")return e;const r=e.split(","),l=[];for(let s=0;s<r.length;s++){const y=r[s].match(/(\d+)-(\d+)/);if(y)for(let C=parseInt(y[1],10);C<=parseInt(y[2],10);C++)l.push(C);else l.push(parseInt(r[s],10))}return l}function P(e,r){const l={};if(r){const s=r.split(/\D/);l.seconds=[parseInt(s[5],10)],l.minutes=[parseInt(s[4],10)],l.hours=[parseInt(s[3],10)],l.dates=[parseInt(s[2],10)],l.months=[parseInt(s[1],10)],l.dows="?"}else{const s=e.replace(/\s\s/g," ").replace(/\s\s/g," ").split(" ");s.length===6?(l.seconds=I(s[0]),l.minutes=I(s[1]),l.hours=I(s[2]),l.dates=I(s[3]),l.months=I(s[4]),l.dows=I(s[5])):(l.seconds=[0],l.minutes=I(s[0]),l.hours=I(s[1]),l.dates=I(s[2]),l.months=I(s[3]),l.dows=I(s[4]))}return l}function B(e){if(e==="*"||e==="?")return e;if(typeof e=="string"&&(e=parseInt(e,10)),typeof e!="object"&&(e=[e]),e.sort(Te),e.length<3)return e.join(",");const r=[];let l=e[0],s=e[0];for(let y=1;y<e.length;y++)e[y]===s+1?s++:(l!==s?l+1===s?r.push(`${l},${s}`):r.push(`${l}-${s}`):r.push(l),l=e[y],s=e[y]);return l!==s?l+1===s?r.push(`${l},${s}`):r.push(`${l}-${s}`):r.push(l),r.join(",")}function A(e){const r=["*","*","*","*","?"];return e.seconds&&(r[0]=B(e.seconds)),r[0]=B(e.minutes),r[1]=B(e.hours),r[2]=B(e.dates),r[3]=B(e.months),r[4]=B(e.dows),r.join(" ")}function W(e,r,l){if(r==="cron"){const s=P(e),y=new Date;return y.setHours(s.hours[0],s.minutes[0]),Array.isArray(s.dows)&&y.setDate(y.getDate()+s.dows[0]-y.getDay()),y}return r==="date"?new Date(e):null}function N(e,r,l){if(r==="cron")return e=new Date(e.getTime()),{minutes:[e.getMinutes()],hours:[e.getHours()]};if(r==="date"){e=new Date(e.getTime()-new Date().getTimezoneOffset()*6e4);const s=e.toISOString();return s.substring(0,s.length-5)}return null}var H=c(59665),Oe=c(71373),De=c(38809),we=c(92631),xe=c(36105),K=c.n(xe),Ge=c(63460),He=c(79117),Ke=c(83994),Ye=c(28301),Ue=c(19867),Qe=c(68582),Xe=c(37529),qe=c(69850),_e=c(15552),pe=c(97712),t=c(4819),Se=Object.defineProperty,Ie=Object.defineProperties,Ne=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,q=(e,r,l)=>r in e?Se(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l,Pe=(e,r)=>{for(var l in r||(r={}))Ze.call(r,l)&&q(e,l,r[l]);if(X)for(var l of X(r))ke.call(r,l)&&q(e,l,r[l]);return e},Ae=(e,r)=>Ie(e,Ne(r)),_=(e,r,l)=>new Promise((s,y)=>{var C=g=>{try{T(l.next(g))}catch(S){y(S)}},i=g=>{try{T(l.throw(g))}catch(S){y(S)}},T=g=>g.done?s(g.value):Promise.resolve(g.value).then(C,i);T((l=l.apply(e,r)).next())});const $e={single:"single_description",double:"double_description",toggle:"toggle_description"},je={field:{padding:"2px 0px"},tableCell:{textAlign:"center"},typeDescription:{fontSize:12,whiteSpace:"normal",fontStyle:"italic"},selectId:{display:"flex"},narrowText:{width:140,marginLeft:8},narrowText2:{minWidth:150,marginRight:8},narrowColor:{width:200},dayTable:{marginLeft:20,display:"inline-block"}},Be=["sunrise","sunriseEnd","goldenHourEnd","solarNoon","goldenHour","sunsetStart","sunset","dusk","nauticalDusk","night","nadir","nightEnd","nauticalDawn","dawn"];function Re(e,r){return e&&typeof e=="object"?e[r]||e.en:e}const p=e=>{var r;const l=e.event.native.intervals&&e.event.native.intervals[0]&&e.event.native.intervals[0].timeOffset?e.event.native.intervals[0].timeOffset/6e4:0,s=e.event.native.intervals&&e.event.native.intervals[0]&&e.event.native.intervals[0].value!==void 0?e.event.native.intervals[0].value:"",[y,C]=(0,w.useState)(!1),[i,T]=(0,w.useState)(e.event),[g,S]=(0,w.useState)(null),[z,R]=(0,w.useState)(!1),[Z,a]=(0,w.useState)(l),[v,f]=(0,w.useState)(s);K().locale(e.language),(0,w.useEffect)(()=>{i.native.oid?e.socket.getObject(i.native.oid).then(n=>S(n)).catch(n=>{console.error(`Cannot get object ${i.native.oid}: ${n}`),S(null)}):S(null)},[i.native.oid,e.socket]);const m=i.native.cron?P(i.native.cron):null;let E="once";Array.isArray(m==null?void 0:m.months)?E="monthly":Array.isArray(m==null?void 0:m.dows)&&(E="daily");let x;i&&(E==="once"?x=W(i.native.start,"date",e.serverTimeZone):(E==="monthly"||E==="daily")&&(x=W(i.native.cron,"cron",e.serverTimeZone)));const F=JSON.stringify(e.event)!==JSON.stringify(i)||Z!==l||v!==s,O=n=>{const d=JSON.parse(JSON.stringify(i));n(d),T(d)},k=(n,d)=>g?g.common.type==="boolean"?t.createElement(o.FormControlLabel,{className:e.classes.narrowText2,control:t.createElement(o.Checkbox,{checked:!!i.native[n],disabled:e.readOnly,onChange:h=>O(b=>b.native[n]=h.target.checked)}),label:e.t(d)}):g.common.states?t.createElement(o.FormControl,{className:e.classes.narrowText2,variant:"standard"},t.createElement(o.InputLabel,null,e.t(d)),t.createElement(o.Select,{value:i.native[n]||"",disabled:e.readOnly,onChange:h=>O(b=>b.native[n]=h.target.value)},Object.keys(g.common.states).map(h=>t.createElement(o.MenuItem,{key:h,value:h},g.common.states[h])))):t.createElement(o.TextField,{className:e.classes.narrowText2,label:e.t(d),value:i.native[n]||"",disabled:e.readOnly,onChange:h=>O(b=>b.native[n]=h.target.value),variant:"standard"}):null,V=()=>g?g.common.type==="boolean"?t.createElement(o.FormControlLabel,{className:e.classes.narrowText2,control:t.createElement(o.Checkbox,{checked:!!v,disabled:e.readOnly,onChange:n=>f(n.target.checked)}),label:e.t("End value")}):g.common.states?t.createElement(o.FormControl,{className:e.classes.narrowText2,variant:"standard"},t.createElement(o.InputLabel,null,e.t("End value")),t.createElement(o.Select,{value:v||"",disabled:e.readOnly,onChange:n=>f(n.target.value)},Object.keys(g.common.states).map(n=>t.createElement(o.MenuItem,{key:n,value:n},g.common.states[n])))):t.createElement(o.TextField,{label:e.t("End value"),value:v||"",disabled:e.readOnly,onChange:n=>f(n.target.value),variant:"standard",className:e.classes.narrowText2}):null,ne=((r=e.systemConfig)==null?void 0:r.firstDayOfWeek)==="monday"?[1,2,3,4,5,6,0]:[0,1,2,3,4,5,6];return t.createElement(o.Dialog,{open:!0,onClose:e.onClose,fullWidth:!0},t.createElement(o.DialogTitle,null,e.t("Configure event")),t.createElement(o.DialogContent,null,y&&t.createElement(j.SelectID,{imagePrefix:"../..",selected:i.native.oid,disabled:e.readOnly,onOk:n=>{O(d=>d.native.oid=n),C(!1)},onClose:()=>C(!1),socket:e.socket}),t.createElement("div",{className:e.classes.field},t.createElement(o.FormControlLabel,{control:t.createElement(o.Checkbox,{checked:!!(i!=null&&i.common.enabled),disabled:e.readOnly,onChange:n=>O(d=>d.common.enabled=n.target.checked)}),label:e.t("Active")})),t.createElement("div",{className:e.classes.field},t.createElement(o.FormControl,{variant:"standard",className:e.classes.narrowText2},t.createElement(o.InputLabel,null,e.t("Time")),t.createElement(o.Select,{value:i.native.astro?"astro":"time",disabled:e.readOnly,onChange:n=>O(d=>{n.target.value==="astro"?d.native.astro="sunrise":delete d.native.astro}),renderValue:n=>e.t(n)},["time","astro"].map(n=>t.createElement(o.MenuItem,{key:n,value:n},t.createElement("div",null,e.t(n)))))),i.native.astro?t.createElement(o.FormControl,{className:e.classes.narrowText,variant:"standard"},t.createElement(o.InputLabel,null,j.I18n.t("Astronomic event")),t.createElement(o.Select,{value:i.native.astro||"",onChange:n=>O(d=>d.native.astro=n.target.value)},Be.map(n=>t.createElement(o.MenuItem,{key:n,value:n},j.I18n.t(n))))):t.createElement(De._,{dateAdapter:Oe.Z},t.createElement(we.j,{label:e.t("Time"),value:x||null,disabled:e.readOnly,onChange:n=>{if(n)try{O(d=>{if(E==="once")d.native.start=N(n.toDate(),"date",e.serverTimeZone);else if(E==="monthly"||E==="daily"){const h=P(d.native.cron),b=N(n.toDate(),"cron",e.serverTimeZone);h.hours=b.hours,h.minutes=b.minutes,d.native.cron=A(h)}})}catch(d){}},renderInput:n=>t.createElement(o.TextField,Ae(Pe({},n),{variant:"standard",className:e.classes.narrowText})),ampm:!1}))),e.isSimulation&&t.createElement("div",{className:e.classes.field},t.createElement(o.TextField,{label:e.t("Time random offset"),value:i.native.timeRandomOffset||0,disabled:e.readOnly,onChange:n=>O(d=>d.native.timeRandomOffset=parseInt(n.target.value)),variant:"standard",InputProps:{endAdornment:t.createElement(o.InputAdornment,{position:"end"},e.t("ms"))}})),t.createElement("div",{className:e.classes.field},!e.isSimulation&&t.createElement(o.FormControl,{variant:"standard",className:e.classes.narrowText2},t.createElement(o.InputLabel,null,e.t("Event type")),t.createElement(o.Select,{value:i.native.type||"",disabled:e.readOnly,onChange:n=>O(d=>d.native.type=n.target.value),renderValue:n=>e.t(n)},["single","double","toggle"].map(n=>t.createElement(o.MenuItem,{key:n,value:n},t.createElement("div",null,t.createElement("div",null,e.t(n)),t.createElement("div",{className:e.classes.typeDescription},e.t($e[n]))))))),i.native.type!=="single"&&t.createElement(o.TextField,{label:e.t("Duration"),value:Z,disabled:e.readOnly,onChange:n=>a(n.target.value),variant:"standard",className:e.classes.narrowText,InputProps:{endAdornment:t.createElement(o.InputAdornment,{position:"end"},e.t("minutes"))}})),t.createElement("div",{className:e.classes.field},t.createElement("div",{className:e.classes.selectId},t.createElement(o.TextField,{label:"Object ID",value:i.native.oid||"",disabled:e.readOnly,onChange:n=>O(d=>d.native.oid=n.target.value),variant:"standard",helperText:Re((g==null?void 0:g.common.name)||"",e.language),fullWidth:!0}),t.createElement(o.Button,{onClick:()=>C(!0)},"..."))),t.createElement("div",{className:e.classes.field},k("startValue",i.native.type==="toggle"?"First value":"Start value"),i.native.type==="double"&&V()),t.createElement("div",{className:e.classes.field},!e.isSimulation&&t.createElement(o.FormControl,{variant:"standard"},t.createElement(o.InputLabel,null,e.t("Period")),t.createElement(o.Select,{value:E||"once",disabled:e.readOnly,onChange:n=>{n.target.value!==i.native.cron&&O(d=>{if(n.target.value==="once")delete d.native.cron,d.native.start=N(x,"date",e.serverTimeZone);else if(n.target.value==="daily"){delete d.native.start;const h=P("0 0 ? * 0-6"),b=N(x,"cron",e.serverTimeZone);h.hours=b.hours,h.minutes=b.minutes,d.native.cron=A(h)}else if(n.target.value==="monthly"){delete d.native.start;const h=P("0 0 ? 1-12 ?"),b=N(x,"cron",e.serverTimeZone);h.hours=b.hours,h.minutes=b.minutes,d.native.cron=A(h)}})}},["once","daily","monthly"].map(n=>t.createElement(o.MenuItem,{key:n,value:n},e.t(n))))),E==="daily"&&t.createElement("table",{className:e.classes.dayTable,style:e.isSimulation?{marginLeft:0}:void 0},t.createElement("thead",null,t.createElement("tr",null,ne.map(n=>t.createElement("td",{key:n,className:e.classes.tableCell},K()().day(n).format("ddd"))))),t.createElement("tbody",null,t.createElement("tr",null,ne.map(n=>{var d;return t.createElement("td",{key:n},t.createElement(o.Checkbox,{checked:((d=m==null?void 0:m.dows)==null?void 0:d.includes(n))||!1,disabled:e.readOnly,onChange:h=>{O(b=>{const $=P(b.native.cron);h.target.checked?$.dows.push(n):$.dows=$.dows.filter(L=>L!==n),b.native.cron=A($)})},size:"small"}))}))))),E==="monthly"&&t.createElement("div",{className:e.classes.field},t.createElement("table",null,t.createElement("thead",null,t.createElement("tr",null,new Array(12).fill(null).map((n,d)=>t.createElement("td",{key:d,className:e.classes.tableCell},K()().month(d).format("MMM"))))),t.createElement("tbody",null,t.createElement("tr",null,new Array(12).fill(null).map((n,d)=>{var h;return t.createElement("td",{key:d},t.createElement(o.Checkbox,{checked:((h=m==null?void 0:m.months)==null?void 0:h.includes(d+1))||!1,disabled:e.readOnly,onChange:b=>{O($=>{const L=P($.native.cron);b.target.checked?L.months.push(d+1):L.months=L.months.filter(Je=>Je!==d+1),$.native.cron=A(L)})},size:"small"}))}))))),t.createElement("div",{className:e.classes.field},t.createElement(o.TextField,{label:"Description",value:(i==null?void 0:i.common.name)||"",disabled:e.readOnly,onChange:n=>O(d=>d.common.name=n.target.value),variant:"standard",fullWidth:!0})),t.createElement("div",{className:e.classes.narrowColor},t.createElement(j.ColorPicker,{value:i.native.color||"",disabled:e.readOnly,onChange:n=>O(d=>d.native.color=n),name:e.t("Color")})),t.createElement("pre",null,JSON.stringify(i,null,2))),t.createElement(o.DialogActions,null,e.readOnly?null:t.createElement(o.Button,{variant:"contained",color:"secondary",startIcon:t.createElement(H.Delete,null),onClick:()=>R(!0)},e.t("Delete")),!e.readOnly&&!e.widget?t.createElement("div",{style:{flex:1}}):null,e.readOnly?null:t.createElement(o.Button,{variant:"contained",color:"primary",disabled:!F,startIcon:t.createElement(H.Save,null),onClick:()=>_(void 0,null,function*(){i.native.type==="single"?i.native.intervals&&delete i.native.intervals:i.native.type==="double"?(i.native.intervals=i.native.intervals||[],i.native.intervals[0]=i.native.intervals[0]||{},i.native.intervals[0].timeOffset=(parseFloat(Z)||1)*6e4,i.native.intervals[0].value=v):i.native.type==="toggle"&&(i.native.intervals=i.native.intervals||[],i.native.intervals[0]=i.native.intervals[0]||{},i.native.intervals[0].timeOffset=(parseFloat(Z)||1)*6e4),yield e.setEvent(i._id,i),e.updateEvents(),e.onClose()})},e.t("Save")),t.createElement(o.Button,{variant:"contained",color:"grey",startIcon:t.createElement(H.Cancel,null),onClick:e.onClose},e.readOnly?e.t("Close"):e.t("Cancel"))),z&&t.createElement(j.Confirm,{title:e.t("Delete event"),text:e.t("Event will be deleted. Confirm?"),suppressQuestionMinutes:5,dialogName:"deleteConfirmDialog",onClose:n=>_(void 0,null,function*(){if(n){try{yield e.deleteEvent(i._id),e.updateEvents()}catch(d){window.alert(`Cannot delete event: ${d}`)}e.onClose()}R(!1)})}))};p.propTypes={systemConfig:u().object,classes:u().object.isRequired,socket:u().object.isRequired,onClose:u().func.isRequired,event:u().object,readOnly:u().bool,updateEvents:u().func.isRequired,serverTimeZone:u().number.isRequired,t:u().func.isRequired,language:u().string.isRequired,widget:u().bool,setEvent:u().func.isRequired,deleteEvent:u().func.isRequired};var Fe=(0,G.withStyles)(je)(p),D=c(4819),Y=(e,r,l)=>new Promise((s,y)=>{var C=g=>{try{T(l.next(g))}catch(S){y(S)}},i=g=>{try{T(l.throw(g))}catch(S){y(S)}},T=g=>g.done?s(g.value):Promise.resolve(g.value).then(C,i);T((l=l.apply(e,r)).next())});const Le=[{type:"single",name:"Single event"},{type:"double",name:"Double event"},{type:"toggle",name:"Toggle event"}],Me=({type:e,t:r})=>{const l=(0,w.useRef)(null);return(0,w.useEffect)(()=>{const s=new U._l(l.current,{eventData:()=>({id:e.type,title:r(e.name),create:!0,extendedProps:{type:e.type}})});return()=>{s.destroy()}},[]),D.createElement("div",{style:{backgroundColor:"rgb(58, 135, 178)",color:"white",cursor:"pointer",fontSize:"14px",padding:"3px 4px 6px 8px",borderRadius:4,marginBottom:20},ref:l},r(e.name))},We=()=>({container:{display:"flex",width:"100%",flex:1},leftBlock:{width:200},calendarBlock:{flex:1,display:"flex"},calendar:{marginRight:20,width:"100%"},leftPaper:{margin:20},leftContent:{display:"flex",flexDirection:"column",padding:"20px 10px"},hr:{width:"100%"}});function ee(e){if(e)return e.startsWith("#")?e.length===4?`#${e[1]}${e[1]}${e[2]}${e[2]}${e[3]}${e[3]}50`:`${e.substring(0,7)}50`:e.startsWith("rgb(")?e.replace("rgb(","rgba(").replace(")",", 0.3)"):e.startsWith("rgba(")?e.replace(/,\s?[.\d]+\)$/,", 0.3)"):e}function te(e){const[r,l]=(0,w.useState)(null),s=e.storageName||"calendar",y=(0,w.useRef)(null),C=(0,w.useRef)(null),i=(0,w.useRef)(null),[T,g]=(0,w.useState)({start:null,end:null});let S=(!e.widget&&window.localStorage.getItem(`${s}Start`),new Date),z=e.viewMode||window.localStorage.getItem(`${s}View`)||"dayGridMonth";e.isSimulation&&(S=new Date,z=e.simulation.native.interval==="day"?"timeGridDay":"timeGridWeek");let R=Le;e.isSimulation&&(R=R.filter(a=>a.type==="single"));const Z=[];return e.events.forEach(a=>{var v;if(!a)return;const f=(v=a.native)!=null&&v.intervals&&a.native.intervals[0]&&a.native.intervals[0].timeOffset?a.native.intervals[0].timeOffset:20,m=a.common.enabled?a.native.color:ee(a.native.color);let E=j.Utils.invertColor(a.native.color,!0);if(a.common.enabled||(E=ee(E)),a.native.cron){const x=W(a.native.cron,"cron",e.serverTimeZone),F=P(a.native.cron);if(x.setFullYear(1970),Array.isArray(F.months)){new J.Ci({dtstart:x,until:T.end||new Date,freq:J.Ci.WEEKLY,bymonth:F.months}).between(T.start||new Date,T.end||new Date).forEach(k=>{const V=a.native.astro?Q().getTimes(k,e.adapterConfig.latitude||e.systemConfig.latitude,e.adapterConfig.longitude||e.systemConfig.longitude)[a.native.astro]:k;Z.push({extendedProps:{eventId:a._id},title:a.common.name,backgroundColor:m,textColor:E,start:V,duration:f,allDay:!1,display:"block"})});return}if(Array.isArray(F.dows)){new J.Ci({dtstart:x,until:T.end||new Date,freq:J.Ci.WEEKLY,byweekday:F.dows.map(k=>k===0?6:k-1)}).between(T.start||new Date,T.end||new Date).forEach(k=>{const V=a.native.astro?Q().getTimes(k,e.systemConfig.latitude,e.systemConfig.longitude)[a.native.astro]:k;Z.push({extendedProps:{eventId:a._id},title:a.common.name,backgroundColor:m,textColor:E,start:V,duration:f,allDay:!1,display:"block"})});return}Z.push({extendedProps:{eventId:a._id},title:a.common.name,duration:f,backgroundColor:m,textColor:E});return}Z.push({extendedProps:{eventId:a._id},title:a.common.name,display:"block",backgroundColor:m,textColor:E,start:W(a.native.start,"date",e.serverTimeZone),end:W(new Date(new Date(a.native.start).getTime()+f),"date",e.serverTimeZone)})}),(0,w.useEffect)(()=>{if(e.widget){const a=()=>{var v;const f=(v=y.current)==null?void 0:v.getApi();f&&(console.log("Scroll to now"),f.scrollToTime(new Date().getTime())),C.current?i.current=null:i.current=setTimeout(()=>a,3e5)};setTimeout(a,1e3)}return()=>{i.current&&clearTimeout(i.current),i.current=null,C.current&&clearTimeout(C.current),C.current=null}},[]),(0,w.useEffect)(()=>{var a;e.isSimulation&&((a=y.current)==null?void 0:a.getApi()).changeView(e.simulation.native.interval==="day"?"timeGridDay":"timeGridWeek",new Date)},[e.simulations,e.simulationId]),D.createElement(D.Fragment,null,D.createElement("style",null,e.theme.palette.mode==="dark"?`
:root {
    --fc-neutral-bg-color: hsla(0,0%,12%);
    --fc-list-event-hover-bg-color: hsla(0,0%,12%);
}
.fc-col-header-cell {
    background-color: #1e1e1e;
}                
`:`
.fc-col-header-cell {
    background-color: #EEEEEE;
}
`),r?D.createElement(Fe,{systemConfig:e.systemConfig,widget:e.widget,event:e.events.find(a=>a._id===r),onClose:()=>l(null),socket:e.socket,updateEvents:e.updateEvents,setEvent:e.setEvent,deleteEvent:e.deleteEvent,serverTimeZone:e.serverTimeZone,readOnly:e.readOnly,t:e.t,language:e.language,isSimulation:e.isSimulation,simulationId:e.simulationId,simulation:e.simulation}):null,D.createElement("div",{className:e.classes.container},!e.hideLeftBlock&&!e.readOnly&&D.createElement("div",{className:e.classes.leftBlock},D.createElement(o.Paper,{elevation:4,className:e.classes.leftPaper},D.createElement("div",{className:e.classes.leftContent},D.createElement("h4",null,e.t("Events")),R.map((a,v)=>D.createElement(Me,{t:e.t,type:a,name:e.t(a.name),key:a.type,index:v})),e.hideLeftBlockHint?null:D.createElement("div",null,e.t("Drag and drop the events above to create a new one.")),e.hideLeftBlockHint?null:D.createElement("hr",{className:e.classes.hr}),e.hideLeftBlockHint?null:D.createElement("div",null,e.t("Use ALT by dragging it to copy the events."))))),D.createElement("div",{className:e.classes.calendarBlock},D.createElement("div",{className:e.classes.calendar},D.createElement(ie.Z,{ref:y,plugins:[de.Z,re.Z,se.Z,U.ZP,oe.Z],weekends:!e.hideWeekends,headerToolbar:e.hideTopBlock?!1:{left:e.hideTopBlockButtons||e.isSimulation?"":"prev,next today",center:e.isSimulation?"":"title",right:e.hideTopBlockButtons||e.isSimulation?"":"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},initialView:z,initialDate:S,editable:!e.readOnly,selectable:!0,selectMirror:!0,nowIndicator:!0,dayMaxEvents:!0,events:Z,height:"calc(100% - 20px)",locales:[ce.Z,ue.Z,me.Z,ve.Z,fe.Z,ge.Z,ye.Z,he.Z,Ee.Z,Ce.Z],locale:e.language,datesSet:a=>{var v,f;(a.start.toString()!==((v=T.start)==null?void 0:v.toString())||a.end.toString()!==((f=T.end)==null?void 0:f.toString()))&&g({start:a.start,end:a.end}),e.widget?(i.current&&clearTimeout(i.current),i.current=null,C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{C.current=null;const m=()=>{var E;const x=(E=y.current)==null?void 0:E.getApi();x==null||x.scrollToTime(new Date().getTime()),C.current?i.current=null:i.current=setTimeout(()=>m,1e3*60*5)};m()},6e4)):window.localStorage.setItem(`${s}View`,a.view.type)},eventClick:a=>l(a.event.extendedProps.eventId),eventResize:a=>{var v;const f=e.events.find(m=>m._id===a.event.extendedProps.eventId);if((v=f.native.intervals)!=null&&v[0].timeOffset){const m=JSON.parse(JSON.stringify(f));m.native.intervals[0].timeOffset+=a.endDelta.milliseconds,e.setEvent(m._id,m),e.updateEvents()}else a.revert()},eventDrop:a=>Y(this,null,function*(){var v;const f=e.events.find(m=>m._id===a.event.extendedProps.eventId);if((v=f==null?void 0:f.native)!=null&&v.cron){const m=JSON.parse(JSON.stringify(f));a.jsEvent.altKey&&(m._id=`${e.calendarPrefix}.event-${(0,M.Z)()}`);const E=P(m.native.cron),x=N(a.event.start,"cron",e.serverTimeZone);E.hours=x.hours,E.minutes=x.minutes,m.native.cron=A(E),yield e.setEvent(m._id,m),e.updateEvents()}else{const m=JSON.parse(JSON.stringify(f));a.jsEvent.altKey&&(m._id=`${e.calendarPrefix}.event-${(0,M.Z)()}`),m.native.start=N(a.event.start,"date",e.serverTimeZone),yield e.setEvent(m._id,m),e.updateEvents()}}),eventReceive:a=>Y(this,null,function*(){const v={_id:`${e.calendarPrefix}.event-${(0,M.Z)()}`,common:{name:a.event.title,enabled:!0},native:{id:Date.now(),start:N(a.event.start,"date",e.serverTimeZone),type:a.event.extendedProps.type,oid:"",startValue:"",color:"#3A87AD"},type:"schedule"};if(a.event.extendedProps.type!=="single"&&(v.native.intervals=[{timeOffset:30*60*1e3}]),e.isSimulation){delete v.native.start;const f=N(a.event.start,"cron",e.serverTimeZone);f.dows=[a.event.start.getDay()],f.dates=["?"],f.months=["*"],v.native.cron=A(f),v._id=`${e.simulationId}.event-${(0,M.Z)()}`}yield e.setEvent(v._id,v),e.updateEvents(),setTimeout(()=>l(v._id),100)}),select:a=>Y(this,null,function*(){if(a.view.calendar.unselect(),e.readOnly)return;const f={_id:`${e.calendarPrefix}.event-${(0,M.Z)()}`,common:{name:e.t("Single event"),enabled:!0},native:{id:Date.now(),start:N(a.date||a.start,"date",e.serverTimeZone),intervals:a.end?[{value:"",timeOffset:a.end.getTime()-a.start.getTime()}]:void 0,type:a.end?"double":"single",oid:"",startValue:"",color:"#3A87AD"},type:"schedule"};yield e.setEvent(f._id,f),yield e.updateEvents(),setTimeout(()=>l(f._id),100)})})))))}te.propTypes={events:u().array,serverTimeZone:u().number,systemConfig:u().object,theme:u().object,socket:u().object,readOnly:u().bool,hideLeftBlock:u().bool,hideTopBlock:u().bool,hideLeftBlockHint:u().bool,hideTopBlockButtons:u().bool,hideWeekends:u().bool,viewMode:u().bool,updateEvents:u().func,instance:u().oneOfType([u().string,u().number]),t:u().func.isRequired,widget:u().bool,language:u().string.isRequired,storageName:u().string,calendarPrefix:u().string,isSimulation:u().bool,simulationId:u().string,setEvent:u().func,adapterConfig:u().object};var Ve=(0,G.withTheme)((0,G.withStyles)(We)(te))}}]);

//# sourceMappingURL=src_Component_Calendar_js-webpack_sharing_consume_default_iobroker_vis-2-widgets-react-dev_io-4dd1d1.0cd49a1e.chunk.js.map